!function(t,i){"function"==typeof define&&define.amd?define("MNSTR",[],function(){return t.MNSTR=i()}):"object"==typeof module&&module.exports?module.exports=i():t.MNSTR=i()}(this,function(){function t(t){return this.context=this,this.parentNode=void 0,this.getData=void 0,this.getElementChildren=void 0,this.getCellRenderer=void 0,this.renderOnInitialize=!0,this.initialScrollToElement=void 0,this.observeCellBounds=!1,this.rememberChildrenExpands=!0,this.thresholdRatio=.5,this.preventWheelBubbling=!1,this.useTransform=!0,this.className="mnstr",this.didRenderFirstElement=void 0,this.didRenderLastElement=void 0,this.t=void 0,this.i=void 0,this.s=void 0,this.h={},this.o=0,this.u=Number.MAX_VALUE,this.l=1,this.v=0,this._=void 0,this.m={},this.p=[],this.g=[],this.initialize(t)}return t.prototype={render:function(t){return this.C(t)},addEventListener:function(t,i){return this.I(t,i)},removeEventListener:function(t,i){return this.L(t,i)},getNode:function(){return this.i},dataUpdated:function(){return this.R()},cellBoundsUpdated:function(){return this.S()},toggleExpandElement:function(t){return this.F(t)},expandElement:function(t){return this.T(t)},collapseElement:function(t){return this.M(t)},isElementExpanded:function(t){return this.k(t)},getRenderedCellRendererForElement:function(t){for(var i=this.H(),s=0;s<i.length;s++){var e=i[s];if(e.B===t){var h=e.N.children[0];return h||e.N.innerHTML}}},scrollToTop:function(){var t=this.A(0);this.O(t.element)},scrollToBottom:function(){var t=this.A(this.v);this.O(t.element)},scrollToElement:function(t){this.O(t)},reset:function(){this.P()},initialize:function(t){for(var i in t)"_"!==i.charAt(0)&&t.hasOwnProperty(i)&&this.hasOwnProperty(i)&&(this[i]=t[i]);return this.renderOnInitialize&&this.C(),this},P:function(){for(this.t=void 0,this.o=0,this.u=Number.MAX_VALUE,this.l=1,this.v=0,this._=void 0,this.m={},this.p=[],this.g=[];this.s.firstChild;)this.s.removeChild(this.s.firstChild);this.j(),this.U(0),this.W()},destroy:function(){},C:function(t){return this.j(),this.q(t),this.D(),this.Y(),this.G(function(){this.J(),this.K()}.bind(this),"render"),this},q:function(t){return this.i&&this.i.parentNode&&(this.i.parentNode.removeChild(this.i),delete this.i),this.i=document.createElement("div"),this.i.classList.add(this.className),this.i.setAttribute("style","overflow-y: auto; -webkit-overflow-scrolling: touch; overflow-scrolling: touch; position: relative;"),this.parentNode=t||this.parentNode||document.body,this.parentNode.appendChild(this.i),this.i},D:function(){return this.s=document.createElement("ul"),this.s.classList.add(this.className+"-list"),this.s.setAttribute("style","position: relative; overflow: hidden; list-style-type: none; margin: 0; padding: 0;"),this.i.appendChild(this.s),this.s},V:function(t,i){var s=document.createElement("iframe");return s.setAttribute("style","position: absolute; left: 0; top: 0; width: 100%; height: 100%; margin: 0; border: none; opacity: 0; pointer-events: none; touch-action: none; z-index: -1000;"),s.onload=function(t){t.target.contentWindow.onresize=i.bind(this)}.bind(this),t.appendChild(s),s},K:function(){this.i.X=this.V(this.i,this.Z)},$:function(t){var i=document.createElement("li");i.classList.add(this.className+"-cell"),i.setAttribute("style","position: absolute; width: 100%; top: 0; left: 0;"),this.observeCellBounds&&(i.X=this.V(i,this.tt));var s=document.createElement("div");return s.classList.add(this.className+"-content"),s.setAttribute("style","width: 100%; margin: 0; border: 0;"),i.appendChild(s),i.N=s,this.s.appendChild(i),i},it:function(t){return parseFloat(window.getComputedStyle(t).height)},st:function(t){return this.i.et=t||this.i.offsetHeight,this.i.et},ht:function(){return this.i.et||this.st()},nt:function(t){return t.rt},ot:function(){return this.ut()-this.ft()},lt:function(t,i){t.rt=i?this.it(t):t.clientHeight},at:function(t){return t.dt||0},ct:function(t,i){i=Math.max(i,0),this.useTransform?t.style.transform="translateY("+i+"px)":t.style.top=i+"px",t.dt=i},vt:function(t){return t.dt+t.rt},ft:function(){return this.p&&this.p.length>0?this.at(this.p[0]):0},ut:function(){return this.p&&this.p.length>0?this.vt(this.p[this.p.length-1]):0},_t:function(){return this.s.children},pt:function(){this.p=this.gt(this._t())},gt:function(t,i){t=t||this._t();var s=[].slice.call(t);return s.sort(function(t,s){return i?s.Et-t.Et:t.Et-s.Et}),s},H:function(){return this.p},Ct:function(){return this.p&&this.p.length>0?this.p[0].Et:-1},xt:function(){return this.p&&this.p.length>0?this.p[this.p.length-1].Et:-1},bt:function(){return this.i.scrollTop},U:function(t){this.i.scrollTop=t},yt:function(t){this.i.scrollTop+=t},It:function(){return this.s.rt?this.s.rt:this.Lt(this.it(this.s))},Rt:function(){var t=this.i.clientHeight;return t+t*(2*this.thresholdRatio)},Lt:function(t){return t=Math.max(t,0),this.s.style.height=t+"px",this.s.rt=t,t},wt:function(){var t=this.ut(),i=this.It();if(this.xt()===this.v)t-i!=0&&this.Lt(t);else{var s=this.l*(this.v+1),e=Math.max(t,s);e!==i&&this.Lt(e)}},St:function(){return-this.i.clientHeight*this.thresholdRatio},Ft:function(){return this.i.clientHeight*this.thresholdRatio+this.i.clientHeight},j:function(){this.t=this.getData?this.getData.call(this.context,this):[],this.Tt(),this.Mt()},R:function(){return this.j(),this.G(function(){this.J();this.bt();var t=this.kt();this.zt();var i=t?this.at(t):void 0;if(this.zt(!0),void 0!==i){var s=this.at(t);this.yt(s-i)}},"dataupdate"),this},A:function(t){if(!this.Ht())return this.Bt(this.t[t],0);for(var i=0,s=this.g.length-1;s>=0;s--){var e=this.g[s];if(e.active&&!(e.index>=t||(i+=e.elementChildren.length,e.index+i<t))){var h=t-(e.index+i-e.elementChildren.length)-1;return this.Bt(e.elementChildren[h],e.level)}}return this.Bt(this.t[t-i],0)},Bt:function(t,i){return{element:t,level:i}},Tt:function(){for(var t=this.t.length-1,i=0,s=0;s<this.g.length;s++){var e=this.g[s];e.active&&(i+=e.elementChildren.length)}this.v=t+i},Ht:function(){return void 0!==this.getElementChildren},Nt:function(t){return this.Ht()?this.getElementChildren.call(this.context,t,this):void 0},At:function(t){for(var i=this.t.indexOf(t),s=i>-1?this.t:void 0,e=void 0,h=0,n=0,r=0;r<this.g.length;r++){var o=this.g[r];if(s===this.t&&!o.elementParent&&o.index>=i)break;if(!s){var u=o.elementChildren.indexOf(t);if(u>-1){i=u,s=o.elementChildren,e=o,h=o.index+1,n=0;continue}}if(e&&o.level>e.level){var f=h+i;if(f<=o.index)return f;n+=o.elementChildren.length}else{if(e)return h+i+n;n+=o.elementChildren.length}}return i>-1?i+n+h:i},Y:function(){this.i.addEventListener("scroll",this.Ot.bind(this)),this.preventWheelBubbling&&this.i.addEventListener("wheel",this.Pt.bind(this))},I:function(t,i){return"object"!=typeof this.h[t]&&(this.h[t]=[]),this.h[t].push(i),this},L:function(t,i){var s;"object"==typeof this.h[t]&&(s=indexOf(this.h[t],i))>-1&&this.h[t].splice(s,1)},jt:function(t){var i,s,e,h=[].slice.call(arguments,1);if("object"==typeof this.h[t])for(e=(s=this.h[t].slice()).length,i=0;i<e;i++)s[i].apply(this,h);this[t]&&this[t].apply(this.context,h)},Ut:function(t,i){0===i&&this.jt("didRenderFirstElement",t,this),i===this.v&&this.jt("didRenderLastElement",t,this)},Pt:function(t){this.Wt(t)},Wt:function(t){var i=t.deltaY,s=i<0&&0===this.i.scrollTop,e=i>0&&this.i.scrollTop>=this.It()-this.ht();(s||e)&&(t.preventDefault(),this.qt||(this.qt=!0,s&&(this.U(1),this.U(0))))},Ot:function(t){this.G(this.Dt,"onscroll",t)},Dt:function(t){this.o=this.i.scrollTop,this.i.scrollTop>this.o?this.qt=!1:this.i.scrollTop<this.o&&(this.qt=!1),this.zt()},O:function(t){var i=this.Yt(t);if(i)return this.U(this.at(i)),void delete this._;var s=this.At(t);if(!(s<0)){var e=s*this.l;this._=t,0!==this.p.length&&this.U(e)}},Gt:function(){this._&&this.scrollToElement(this._)},G:function(t,i){if(!this.m[i]){this.m[i]=!0;var s=[].slice.call(arguments,2);window.requestAnimationFrame(function(){t.apply(this,s),delete this.m[i]}.bind(this))}},W:function(){this.G(this.J,"cellcount")},J:function(){for(;0===this.H().length||this.u*(this._t().length-2)<this.Rt();){var t=this.Ct(),i=this.xt(),s=i<this.v;if(!(i<this.v||t>0))break;var e=s?++i:--t;if((e=this.initialScrollToElement&&0===this.H().length?this.At(this.initialScrollToElement):e)<0||e>this.v)break;var h=this.$();this.Jt(h,e),this.lt(h);var n=s?this.ut():this.ft()-this.nt(h);this.ct(h,n),this.Kt(),this.pt(),this.wt()}this.initialScrollToElement&&(this.kt(!0),this.O(this.initialScrollToElement),this.initialScrollToElement=void 0);for(var r=this.H(),o=this.Rt(),u=r.length-1;u>=0;u--){((h=r[u]).Et<0||h.Et>this.v||u===r.length-1&&this.u*(r.length-2)-this.nt(h)>o)&&(this.s.removeChild(h),r.splice(u,1),this.Kt(),this.wt())}this.pt()},kt:function(t){if(0!==this.p.length){this.wt();for(var i,s=0,e=this.ft(),h=this.bt(),n=void 0,r=0;r<this.p.length;r++){var o=this.p[r];if(t){var u=o.Et*this.l;e=this.at(o)-u,n=o;break}var f=this.At(o.B);if(-1!==f){if(f===o.Et)return;if(s=o.Et-f,Math.abs(s)>r){e=s*this.l,n=o;break}}}for(r=0;r<this.p.length;r++){o=this.p[r];var l=t&&void 0!==i?i:this.at(o)-e;o.Et-=s,this.ct(o,l),i=l+this.nt(o)}return this.wt(),this.U(h-e),n}},Kt:function(){var t=this._t(),i=0;this.u=Number.MAX_VALUE;for(var s=0;s<t.length;s++){var e=this.nt(t[s]);i+=e,this.u=Math.min(this.u,e)}this.l=i/t.length},Jt:function(t,i){var s=this.A(i);if(t.Qt=!0,s){var e=s.element,h=s.level;if(e&&e!==t.B){var n=this.Ht()?this.Vt(e):void 0,r=this.getCellRenderer?this.getCellRenderer.call(this.context,e,i,void 0!==n,this):"";return this.Xt(t),"string"==typeof r||r instanceof String?t.N.innerHTML=r:(t.N.innerHTML="",t.N.appendChild(r)),this.observeCellBounds&&window.requestAnimationFrame(function(){this.Zt(t)}.bind(this)),n?(t.classList.add("expanded"),t.$t=n):(t.classList.remove("expanded"),delete t.$t),t.dataset.level=h,t.B=e,t.Et=i,t.ti=h,this.Ut(e,i),t}}},ii:function(t){this.G(this.zt,"updatecells",t)},zt:function(t){var i=this.bt(),s=this.St(),e=this.Ft(),h=this.ft(),n=this.ut(),r=this.Ct(),o=this.xt(),u=this.H(),f=!1,l=-1,a=0,d=void 0,c=!1,v=h>i+s,_=h>i+e,m=n<i+s,p=n<i+e;if(t)a=1,d=h;else{if(!v&&!p)return;if(_||m){var g=Math.round(Math.max(i+s,0)/this.l);a=1,d=(l=Math.min(g,this.v-u.length+1))*this.l,f=!0}else if(p&&o<this.v)l=o+(a=1),d=n;else{if(!(v&&r>0))return;l=r+(a=-1),d=h}}for(var E=0;E<u.length;E++){var C=u[a>0?E:u.length-1-E],x=t?C.Et:l,b=x>=0&&x<=this.v?this.Jt(C,x):void 0;if(t||b){if(this.lt(C),a>0)this.ct(C,d),d+=x>-1?this.nt(C):0;else if(a<0){var y=0;if(d-=x>-1?this.nt(C):0,0===x&&0!==d&&(y=d,d=0),this.ct(C,d),y)return this.pt(),this.zt(!0),void this.U(i-y)}c=c||this.nt(C)>0&&this.nt(C)<this.u,0}if(b&&!t&&(l+=a,0),!t&&!f&&(a>0&&d>i+e||a<0&&d<i+s))break}this.pt(),this.wt(),(c||t)&&(this.Kt(),this.J()),this.Gt()},Yt:function(t){for(var i=0;i<this.p.length;i++){var s=this.p[i];if(s.B===t)return s}},S:function(){this.G(function(){this.zt(!0)}.bind(this),"cellbounds")},F:function(t){var i=this.Yt(t);i&&this.si(i)},T:function(t){var i=this.Yt(t);i&&this.ei(i)},M:function(t){var i=this.Yt(t);i&&this.hi(i)},k:function(t){var i=this.Yt(t);return!!i&&void 0!==i.$t},si:function(t){t.$t?this.hi(t):this.ei(t)},hi:function(t){t.classList.remove("expanded"),this.ni(t),this.ii(!0)},ei:function(t){t.classList.add("expanded"),this.ri(t),this.ii(!0)},Vt:function(t){for(var i=0;i<this.g.length;i++){var s=this.g[i];if(s.element===t)return s}},oi:function(t,i){var s=this.ui(t);return{active:!0,element:t,elementIndex:s?this.Nt(s).indexOf(t):this.t.indexOf(t),elementChildren:this.Nt(t),elementParent:s,index:void 0,level:i,totalLength:0}},ui:function(t){for(var i=0;i<this.g.length;i++){var s=this.g[i];if(s.elementChildren.indexOf(t)>-1)return s.element}},ri:function(t){var i=this.oi(t.B,t.ti+1);if(this.g.push(i),t.$t=i,this.fi(),this.rememberChildrenExpands)for(var s=this.g.indexOf(i)+1;s<this.g.length;s++){var e=this.g[s];if(e.level<=i.level)break;e.active=!0}this.li()},ni:function(t){for(var i=t.$t,s=[i],e=this.g.indexOf(i)+1;e<this.g.length;e++){var h=this.g[e];if(h.level<=i.level)break;s.push(h)}delete t.$t;for(e=0;e<s.length;e++){var n=s[e];n===i?this.ai(this.g,n):this.rememberChildrenExpands?n.active=!1:this.ai(this.g,n)}this.li()},Mt:function(){this.fi();for(var t=[],i=0;i<this.g.length;i++){for(var s=this.g[i],e=s.elementParent?this.Nt(s.elementParent):this.t,h=!1,n=0;n<t.length;n++){t[n].element===s.elementParent&&(h=!0)}h||-1===e.indexOf(s.element)?(s.elementChildren=[],t.push(s)):s.elementChildren=this.Nt(s.element)}for(i=0;i<t.length;i++)this.ai(this.g,t[i]);this.li()},fi:function(){for(var t=[],i=0;i<this.g.length;i++){var s=this.g[i];if(s.elementParent){for(var e=!1,h=!1,n=void 0,r=0;r<t.length;r++){var o=t[r];if(e&&o.elementParent===n.elementParent&&o.elementIndex>s.elementIndex||e&&o.elementParent===s.elementParent&&o.elementIndex>s.elementIndex||e&&o.level<s.level||o.elementParent===s.element){t.splice(r,0,s),h=!0;break}o.element===s.elementParent&&(e=!0),n=o}h||t.push(s)}else{for(h=!1,r=0;r<t.length;r++){if(!(o=t[r]).elementParent&&o.elementIndex>s.elementIndex||o.elementParent===s.element){t.splice(r,0,s),h=!0;break}}h||t.push(s)}}this.g=t},li:function(){for(var t=[],i=void 0,s=0,e=0;e<this.g.length;e++){var h=this.g[e];if(h.active){i&&(h.level>i.level?t.push(i):h.level<i.level&&(t=t.slice(0,t.length-(i.level-h.level)))),h.totalLength=h.elementChildren.length;for(var n=0;n<t.length;n++)t[n].totalLength+=h.totalLength;var r=t.length>0?t[t.length-1]:void 0,o=r?r.index:void 0,u=r?r.totalLength-h.totalLength:0,f=r?r.elementChildren.length:0,l=t&&t.length>0?t[t.length-1].elementChildren.indexOf(h.element):this.t.indexOf(h.element),a=u-f+l+(void 0!==o?o+1:0)+(1===h.level?s:0);h.elementIndex=l,h.index=a,i=h,s+=h.elementChildren.length}}this.Tt()},Z:function(t){this.di(),this.G(this.ci,"resizelist")},ci:function(){this.zt(!0),this.zt(),this.st(),this.vi()},tt:function(t){this.S()},Xt:function(t){t.X&&t.X.contentWindow&&t.X.contentWindow.onresize&&(t.X.contentWindow._i=t.X.contentWindow.onresize,t.X.contentWindow.onresize=void 0)},Zt:function(t){this.observeCellBounds&&t.X&&t.X.contentWindow&&t.X.contentWindow._i&&(t.X.contentWindow.onresize=t.X.contentWindow._i,t.X.contentWindow._i=void 0)},di:function(){if(this.observeCellBounds)for(var t=0;t<this.p.length;t++)this.Xt(this.p[t])},vi:function(){if(this.observeCellBounds)for(var t=0;t<this.p.length;t++)this.Zt(this.p[t])},ai:function(t,i){return t.splice(t.indexOf(i),1)}},t});