!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.MNSTR=t()}(this,function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var n=t(function(e){!function(t){var n,r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag",u=t.regeneratorRuntime;if(u)e.exports=u;else{(u=t.regeneratorRuntime=e.exports).wrap=x;var c="suspendedStart",h="suspendedYield",d="executing",f="completed",v={},p={};p[s]=function(){return this};var m=Object.getPrototypeOf,_=m&&m(m(O([])));_&&_!==r&&i.call(_,s)&&(p=_);var g=N.prototype=E.prototype=Object.create(p);b.prototype=g.constructor=N,N.constructor=b,N[l]=b.displayName="GeneratorFunction",u.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},u.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,N):(e.__proto__=N,l in e||(e[l]="GeneratorFunction")),e.prototype=Object.create(g),e},u.awrap=function(e){return{__await:e}},C(k.prototype),k.prototype[a]=function(){return this},u.AsyncIterator=k,u.async=function(e,t,n,r){var i=new k(x(e,t,n,r));return u.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},C(g),g[l]="Generator",g[s]=function(){return this},g.toString=function(){return"[object Generator]"},u.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},u.values=O,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(T),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,i){return a.type="throw",a.arg=e,t.next=r,i&&(t.method="next",t.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var l=i.call(s,"catchLoc"),u=i.call(s,"finallyLoc");if(l&&u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;T(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:O(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),v}}}function x(e,t,n,r){var i=t&&t.prototype instanceof E?t:E,o=Object.create(i.prototype),s=new I(r||[]);return o._invoke=function(e,t,n){var r=c;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw o;return L()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var a=w(s,n);if(a){if(a===v)continue;return a}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===c)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var l=y(e,t,n);if("normal"===l.type){if(r=n.done?f:h,l.arg===v)continue;return{value:l.arg,done:n.done}}"throw"===l.type&&(r=f,n.method="throw",n.arg=l.arg)}}}(e,n,s),o}function y(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function E(){}function b(){}function N(){}function C(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function k(e){var t;this._invoke=function(n,r){function o(){return new Promise(function(t,o){!function t(n,r,o,s){var a=y(e[n],e,r);if("throw"!==a.type){var l=a.arg,u=l.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then(function(e){t("next",e,o,s)},function(e){t("throw",e,o,s)}):Promise.resolve(u).then(function(e){l.value=e,o(l)},s)}s(a.arg)}(n,r,t,o)})}return t=t?t.then(o,o):o()}}function w(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,w(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=y(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,v;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,v):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function T(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function I(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function O(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:L}}function L(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())}),r=function(){return this}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=i&&r.regeneratorRuntime;r.regeneratorRuntime=void 0;var s=n;if(i)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}var a=s,l=Math.ceil,u=Math.floor,c=function(e){return isNaN(e=+e)?0:(e>0?u:l)(e)},h=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},d=t(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),f=t(function(e){var t=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=t)}),v=(f.version,function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}),p=function(e,t,n){if(v(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},m=function(e){return"object"==typeof e?null!==e:"function"==typeof e},_=function(e){if(!m(e))throw TypeError(e+" is not an object!");return e},g=function(e){try{return!!e()}catch(e){return!0}},x=!g(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),y=d.document,E=m(y)&&m(y.createElement),b=function(e){return E?y.createElement(e):{}},N=!x&&!g(function(){return 7!=Object.defineProperty(b("div"),"a",{get:function(){return 7}}).a}),C=Object.defineProperty,k={f:x?Object.defineProperty:function(e,t,n){if(_(e),t=function(e,t){if(!m(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!m(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}(t,!0),_(n),N)try{return C(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},w=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},S=x?function(e,t,n){return k.f(e,t,w(1,n))}:function(e,t,n){return e[t]=n,e},T={}.hasOwnProperty,I=function(e,t){return T.call(e,t)},O=function(e,t,n){var r,i,o,s=e&O.F,a=e&O.G,l=e&O.S,u=e&O.P,c=e&O.B,h=e&O.W,v=a?f:f[t]||(f[t]={}),m=v.prototype,_=a?d:l?d[t]:(d[t]||{}).prototype;for(r in a&&(n=t),n)(i=!s&&_&&void 0!==_[r])&&I(v,r)||(o=i?_[r]:n[r],v[r]=a&&"function"!=typeof _[r]?n[r]:c&&i?p(o,d):h&&_[r]==o?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(o):u&&"function"==typeof o?p(Function.call,o):o,u&&((v.virtual||(v.virtual={}))[r]=o,e&O.R&&m&&!m[r]&&S(m,r,o)))};O.F=1,O.G=2,O.S=4,O.P=8,O.B=16,O.W=32,O.U=64,O.R=128;var L,M=O,P=S,H={},R={}.toString,A=function(e){return R.call(e).slice(8,-1)},F=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==A(e)?e.split(""):Object(e)},j=function(e){return F(h(e))},B=Math.min,z=function(e){return e>0?B(c(e),9007199254740991):0},V=Math.max,D=Math.min,U=t(function(e){var t=d["__core-js_shared__"]||(d["__core-js_shared__"]={});(e.exports=function(e,n){return t[e]||(t[e]=void 0!==n?n:{})})("versions",[]).push({version:f.version,mode:"pure",copyright:"Â© 2018 Denis Pushkarev (zloirock.ru)"})}),G=0,W=Math.random(),q=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++G+W).toString(36))},X=U("keys"),Y=function(e){return X[e]||(X[e]=q(e))},K=(L=!1,function(e,t,n){var r,i=j(e),o=z(i.length),s=function(e,t){return(e=c(e))<0?V(e+t,0):D(e,t)}(n,o);if(L&&t!=t){for(;o>s;)if((r=i[s++])!=r)return!0}else for(;o>s;s++)if((L||s in i)&&i[s]===t)return L||s||0;return!L&&-1}),J=Y("IE_PROTO"),Q="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Z=Object.keys||function(e){return function(e,t){var n,r=j(e),i=0,o=[];for(n in r)n!=J&&I(r,n)&&o.push(n);for(;t.length>i;)I(r,n=t[i++])&&(~K(o,n)||o.push(n));return o}(e,Q)},$=x?Object.defineProperties:function(e,t){_(e);for(var n,r=Z(t),i=r.length,o=0;i>o;)k.f(e,n=r[o++],t[n]);return e},ee=d.document,te=ee&&ee.documentElement,ne=Y("IE_PROTO"),re=function(){},ie=function(){var e,t=b("iframe"),n=Q.length;for(t.style.display="none",te.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),ie=e.F;n--;)delete ie.prototype[Q[n]];return ie()},oe=Object.create||function(e,t){var n;return null!==e?(re.prototype=_(e),n=new re,re.prototype=null,n[ne]=e):n=ie(),void 0===t?n:$(n,t)},se=t(function(e){var t=U("wks"),n=d.Symbol,r="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:q)("Symbol."+e))}).store=t}),ae=k.f,le=se("toStringTag"),ue=function(e,t,n){e&&!I(e=n?e:e.prototype,le)&&ae(e,le,{configurable:!0,value:t})},ce={};S(ce,se("iterator"),function(){return this});var he,de=function(e,t,n){e.prototype=oe(ce,{next:w(1,n)}),ue(e,t+" Iterator")},fe=function(e){return Object(h(e))},ve=Y("IE_PROTO"),pe=Object.prototype,me=Object.getPrototypeOf||function(e){return e=fe(e),I(e,ve)?e[ve]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?pe:null},_e=se("iterator"),ge=!([].keys&&"next"in[].keys()),xe=function(){return this},ye=function(e,t,n,r,i,o,s){de(n,t,r);var a,l,u,c=function(e){if(!ge&&e in v)return v[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},h=t+" Iterator",d="values"==i,f=!1,v=e.prototype,p=v[_e]||v["@@iterator"]||i&&v[i],m=p||c(i),_=i?d?c("entries"):m:void 0,g="Array"==t&&v.entries||p;if(g&&(u=me(g.call(new e)))!==Object.prototype&&u.next&&ue(u,h,!0),d&&p&&"values"!==p.name&&(f=!0,m=function(){return p.call(this)}),s&&(ge||f||!v[_e])&&S(v,_e,m),H[t]=m,H[h]=xe,i)if(a={values:d?m:c("values"),keys:o?m:c("keys"),entries:_},s)for(l in a)l in v||P(v,l,a[l]);else M(M.P+M.F*(ge||f),t,a);return a},Ee=(he=!0,function(e,t){var n,r,i=String(h(e)),o=c(t),s=i.length;return o<0||o>=s?he?"":void 0:(n=i.charCodeAt(o))<55296||n>56319||o+1===s||(r=i.charCodeAt(o+1))<56320||r>57343?he?i.charAt(o):n:he?i.slice(o,o+2):r-56320+(n-55296<<10)+65536});ye(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=Ee(t,n),this._i+=e.length,{value:e,done:!1})});var be=function(e,t){return{value:t,done:!!e}};ye(Array,"Array",function(e,t){this._t=j(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,be(1)):be(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values");H.Arguments=H.Array;for(var Ne=se("toStringTag"),Ce="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),ke=0;ke<Ce.length;ke++){var we=Ce[ke],Se=d[we],Te=Se&&Se.prototype;Te&&!Te[Ne]&&S(Te,Ne,we),H[we]=H.Array}var Ie,Oe,Le,Me=se("toStringTag"),Pe="Arguments"==A(function(){return arguments}()),He=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Me))?n:Pe?A(t):"Object"==(r=A(t))&&"function"==typeof t.callee?"Arguments":r},Re=function(e,t,n,r){try{return r?t(_(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&_(i.call(e)),t}},Ae=se("iterator"),Fe=Array.prototype,je=se("iterator"),Be=f.getIteratorMethod=function(e){if(null!=e)return e[je]||e["@@iterator"]||H[He(e)]},ze=t(function(e){var t={},n={},r=e.exports=function(e,r,i,o,s){var a,l,u,c,h,d=s?function(){return e}:Be(e),f=p(i,o,r?2:1),v=0;if("function"!=typeof d)throw TypeError(e+" is not iterable!");if(void 0===(h=d)||H.Array!==h&&Fe[Ae]!==h){for(u=d.call(e);!(l=u.next()).done;)if((c=Re(u,f,l.value,r))===t||c===n)return c}else for(a=z(e.length);a>v;v++)if((c=r?f(_(l=e[v])[0],l[1]):f(e[v]))===t||c===n)return c};r.BREAK=t,r.RETURN=n}),Ve=se("species"),De=function(e,t){var n,r=_(e).constructor;return void 0===r||null==(n=_(r)[Ve])?t:v(n)},Ue=d.process,Ge=d.setImmediate,We=d.clearImmediate,qe=d.MessageChannel,Xe=d.Dispatch,Ye=0,Ke={},Je=function(){var e=+this;if(Ke.hasOwnProperty(e)){var t=Ke[e];delete Ke[e],t()}},Qe=function(e){Je.call(e.data)};Ge&&We||(Ge=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return Ke[++Ye]=function(){!function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}e.apply(n,t)}("function"==typeof e?e:Function(e),t)},Ie(Ye),Ye},We=function(e){delete Ke[e]},"process"==A(Ue)?Ie=function(e){Ue.nextTick(p(Je,e,1))}:Xe&&Xe.now?Ie=function(e){Xe.now(p(Je,e,1))}:qe?(Le=(Oe=new qe).port2,Oe.port1.onmessage=Qe,Ie=p(Le.postMessage,Le,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(Ie=function(e){d.postMessage(e+"","*")},d.addEventListener("message",Qe,!1)):Ie="onreadystatechange"in b("script")?function(e){te.appendChild(b("script")).onreadystatechange=function(){te.removeChild(this),Je.call(e)}}:function(e){setTimeout(p(Je,e,1),0)});var Ze={set:Ge,clear:We},$e=Ze.set,et=d.MutationObserver||d.WebKitMutationObserver,tt=d.process,nt=d.Promise,rt="process"==A(tt);function it(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=v(t),this.reject=v(n)}var ot={f:function(e){return new it(e)}},st=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},at=d.navigator,lt=at&&at.userAgent||"",ut=function(e,t){if(_(e),m(t)&&t.constructor===e)return t;var n=ot.f(e);return(0,n.resolve)(t),n.promise},ct=se("species"),ht=se("iterator"),dt=!1;try{[7][ht]().return=function(){dt=!0}}catch(e){}var ft,vt,pt,mt,_t,gt,xt=Ze.set,yt=function(){var e,t,n,r=function(){var r,i;for(rt&&(r=tt.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(rt)n=function(){tt.nextTick(r)};else if(!et||d.navigator&&d.navigator.standalone)if(nt&&nt.resolve){var i=nt.resolve(void 0);n=function(){i.then(r)}}else n=function(){$e.call(d,r)};else{var o=!0,s=document.createTextNode("");new et(r).observe(s,{characterData:!0}),n=function(){s.data=o=!o}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}(),Et=d.TypeError,bt=d.process,Nt=bt&&bt.versions,Ct=Nt&&Nt.v8||"",kt=d.Promise,wt="process"==He(bt),St=function(){},Tt=vt=ot.f,It=!!function(){try{var e=kt.resolve(1),t=(e.constructor={})[se("species")]=function(e){e(St,St)};return(wt||"function"==typeof PromiseRejectionEvent)&&e.then(St)instanceof t&&0!==Ct.indexOf("6.6")&&-1===lt.indexOf("Chrome/66")}catch(e){}}(),Ot=function(e){var t;return!(!m(e)||"function"!=typeof(t=e.then))&&t},Lt=function(e,t){if(!e._n){e._n=!0;var n=e._c;yt(function(){for(var r=e._v,i=1==e._s,o=0,s=function(t){var n,o,s,a=i?t.ok:t.fail,l=t.resolve,u=t.reject,c=t.domain;try{a?(i||(2==e._h&&Ht(e),e._h=1),!0===a?n=r:(c&&c.enter(),n=a(r),c&&(c.exit(),s=!0)),n===t.promise?u(Et("Promise-chain cycle")):(o=Ot(n))?o.call(n,l,u):l(n)):u(r)}catch(e){c&&!s&&c.exit(),u(e)}};n.length>o;)s(n[o++]);e._c=[],e._n=!1,t&&!e._h&&Mt(e)})}},Mt=function(e){xt.call(d,function(){var t,n,r,i=e._v,o=Pt(e);if(o&&(t=st(function(){wt?bt.emit("unhandledRejection",i,e):(n=d.onunhandledrejection)?n({promise:e,reason:i}):(r=d.console)&&r.error&&r.error("Unhandled promise rejection",i)}),e._h=wt||Pt(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},Pt=function(e){return 1!==e._h&&0===(e._a||e._c).length},Ht=function(e){xt.call(d,function(){var t;wt?bt.emit("rejectionHandled",e):(t=d.onrejectionhandled)&&t({promise:e,reason:e._v})})},Rt=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),Lt(t,!0))},At=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw Et("Promise can't be resolved itself");(t=Ot(e))?yt(function(){var r={_w:n,_d:!1};try{t.call(e,p(At,r,1),p(Rt,r,1))}catch(e){Rt.call(r,e)}}):(n._v=e,n._s=1,Lt(n,!1))}catch(e){Rt.call({_w:n,_d:!1},e)}}};It||(kt=function(e){!function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!")}(this,kt,"Promise","_h"),v(e),ft.call(this);try{e(p(At,this,1),p(Rt,this,1))}catch(e){Rt.call(this,e)}},(ft=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(e,t,n){for(var r in t)n&&e[r]?e[r]=t[r]:S(e,r,t[r]);return e}(kt.prototype,{then:function(e,t){var n=Tt(De(this,kt));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=wt?bt.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&Lt(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),pt=function(){var e=new ft;this.promise=e,this.resolve=p(At,e,1),this.reject=p(Rt,e,1)},ot.f=Tt=function(e){return e===kt||e===mt?new pt(e):vt(e)}),M(M.G+M.W+M.F*!It,{Promise:kt}),ue(kt,"Promise"),gt="function"==typeof f[_t="Promise"]?f[_t]:d[_t],x&&gt&&!gt[ct]&&k.f(gt,ct,{configurable:!0,get:function(){return this}}),mt=f.Promise,M(M.S+M.F*!It,"Promise",{reject:function(e){var t=Tt(this);return(0,t.reject)(e),t.promise}}),M(M.S+!0*M.F,"Promise",{resolve:function(e){return ut(this===mt?kt:this,e)}}),M(M.S+M.F*!(It&&function(e,t){if(!t&&!dt)return!1;var n=!1;try{var r=[7],i=r[ht]();i.next=function(){return{done:n=!0}},r[ht]=function(){return i},e(r)}catch(e){}return n}(function(e){kt.all(e).catch(St)})),"Promise",{all:function(e){var t=this,n=Tt(t),r=n.resolve,i=n.reject,o=st(function(){var n=[],o=0,s=1;ze(e,!1,function(e){var a=o++,l=!1;n.push(void 0),s++,t.resolve(e).then(function(e){l||(l=!0,n[a]=e,--s||r(n))},i)}),--s||r(n)});return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=Tt(t),r=n.reject,i=st(function(){ze(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}}),M(M.P+M.R,"Promise",{finally:function(e){var t=De(this,f.Promise||d.Promise),n="function"==typeof e;return this.then(n?function(n){return ut(t,e()).then(function(){return n})}:e,n?function(n){return ut(t,e()).then(function(){throw n})}:e)}}),M(M.S,"Promise",{try:function(e){var t=ot.f(this),n=st(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}});var Ft=f.Promise,jt=t(function(e){e.exports={default:Ft,__esModule:!0}});e(jt);var Bt=e(t(function(e,t){t.__esModule=!0;var n,r=(n=jt)&&n.__esModule?n:{default:n};t.default=function(e){return function(){var t=e.apply(this,arguments);return new r.default(function(e,n){return function i(o,s){try{var a=t[o](s),l=a.value}catch(e){return void n(e)}if(!a.done)return r.default.resolve(l).then(function(e){i("next",e)},function(e){i("throw",e)});e(l)}("next")})}}})),zt={f:Object.getOwnPropertySymbols},Vt={f:{}.propertyIsEnumerable},Dt=Object.assign,Ut=!Dt||g(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=Dt({},e)[n]||Object.keys(Dt({},t)).join("")!=r})?function(e,t){for(var n=fe(e),r=arguments.length,i=1,o=zt.f,s=Vt.f;r>i;)for(var a,l=F(arguments[i++]),u=o?Z(l).concat(o(l)):Z(l),c=u.length,h=0;c>h;)s.call(l,a=u[h++])&&(n[a]=l[a]);return n}:Dt;M(M.S+M.F,"Object",{assign:Ut});var Gt=f.Object.assign,Wt=t(function(e){e.exports={default:Gt,__esModule:!0}});e(Wt);var qt=e(t(function(e,t){t.__esModule=!0;var n,r=(n=Wt)&&n.__esModule?n:{default:n};t.default=r.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}})),Xt=e(t(function(e,t){t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}}));M(M.S+M.F*!x,"Object",{defineProperty:k.f});var Yt=f.Object,Kt=function(e,t,n){return Yt.defineProperty(e,t,n)},Jt=t(function(e){e.exports={default:Kt,__esModule:!0}});e(Jt);var Qt=e(t(function(e,t){t.__esModule=!0;var n,r=(n=Jt)&&n.__esModule?n:{default:n};t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(e,i.key,i)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()}));return function(){function e(t){Xt(this,e),this.context=this,this.parentNode=void 0,this.getData=void 0,this.getElementChildren=void 0,this.getCellRenderer=void 0,this.virtualEnvironment=!1,this.needUpdateVirtualDOM=void 0,this.renderOnInitialize=!0,this.initialScrollToElement=void 0,this.initialScrollToOptions=void 0,this.observeCellBounds=!1,this.rememberChildrenExpands=!0,this.thresholdRatio=.5,this.useTransform=!0,this.className="mnstr",this.didRenderFirstElement=void 0,this.didRenderLastElement=void 0,this.firstInBoundsElementChanged=void 0,this.lastInBoundsElementChanged=void 0,this._data=[],this._scrollNode=void 0,this._listNode=void 0,this._events={},this._lowestCellHeigh=Number.MAX_VALUE,this._averageCellHeight=1,this._currentMaxIndex=0,this._initialScrollToElement=void 0,this._cachedScrollToElement=void 0,this._cachedScrollToOptions=void 0,this._firstInBoundsElement=void 0,this._lastInBoundsElement=void 0,this._frameRequests={},this._cellsSorted=[],this._vElements=[],this._expandInformations=[],this._updatingCells=!1,t=t||{},Object.keys(t).forEach(function(e){"_"===e.charAt(0)&&delete t[e]}),qt(this,t),this._initialScrollToElement=this.initialScrollToElement,this._cachedScrollToElement=this._initialScrollToElement,this._cachedScrollToOptions=this.initialScrollToOptions,this.renderOnInitialize&&this.render()}return Qt(e,[{key:"destroy",value:function(){console.error("wheeee.")}},{key:"reset",value:function(){var e=Bt(a.mark(function e(){return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._data=[],this._lowestCellHeight=Number.MAX_VALUE,this._averageCellHeight=1,this._currentMaxIndex=0,this._cachedScrollToElement=void 0,this._cachedScrollToOptions=void 0,this._frameRequests={},this._cellsSorted=[],this._expandInformations=[],this._vElements=[],!this.virtualEnvironment){e.next=15;break}return e.next=13,this.updateVirtualDOM();case 13:e.next=16;break;case 15:for(;this._listNode.firstChild;)this._listNode.removeChild(this._listNode.firstChild);case 16:this.needUpdate(),this.setScrollPosition(0),this.rUpdateCells();case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"exportRestoreState",value:function(){var e=this.getCellsSorted()[0];return{scrollTop:this.getScrollPosition(),index:e?e.__index:0,position:e?this.getNodeTop(e):0,height:this.getNodeHeight(this._listNode)}}},{key:"render",value:function(e){var t=this;return this.needUpdate(),this.renderScrollNode(e),this.renderListNode(),this.initScrollListener(),this.rAF(Bt(a.mark(function e(){return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.updateCells(!0);case 2:t.renderListResizeObserver();case 3:case"end":return e.stop()}},e,t)})),"render"),this}},{key:"renderScrollNode",value:function(e){return this._scrollNode&&this._scrollNode.parentNode&&this._scrollNode.parentNode.removeChild(this._scrollNode),this._scrollNode=document.createElement("div"),this._scrollNode.classList.add(this.className),this._scrollNode.setAttribute("style","overflow-y: auto; -webkit-overflow-scrolling: touch; overflow-scrolling: touch; position: relative; will-change: transform;"),this.parentNode=e||this.parentNode||document.body,this.parentNode.appendChild(this._scrollNode),this._scrollNode}},{key:"renderListNode",value:function(){return this._listNode=document.createElement("ul"),this._listNode.classList.add(this.className+"-list"),this._listNode.setAttribute("style","position: relative; overflow: hidden; list-style-type: none; margin: 0; padding: 0;"),this._scrollNode.appendChild(this._listNode),this._listNode}},{key:"renderIFrame",value:function(e,t){var n=this,r=document.createElement("iframe");return r.setAttribute("style","position: absolute; left: 0; top: 0; width: 100%; height: 100%; margin: 0; border: none; opacity: 0; pointer-events: none; touch-action: none; z-index: -1000;"),r.onload=function(e){e.target.contentWindow.onresize=t.bind(n)},e.appendChild(r),r}},{key:"renderListResizeObserver",value:function(){this._scrollNode.__frameNode=this.renderIFrame(this._scrollNode,this.onResizeScrollNode)}},{key:"renderCell",value:function(){var e=document.createElement("li");e.classList.add(this.className+"-cell"),e.setAttribute("style","position: absolute; width: 100%; top: 0; left: 0;"),e.__frameNode=this.observeCellBounds?this.renderIFrame(e,this.onResizeCell):void 0;var t=document.createElement("div");return t.classList.add(this.className+"-content"),t.setAttribute("style","width: 100%; margin: 0; border: 0;"),e.appendChild(t),e.__contentNode=t,this._listNode.appendChild(e),e}},{key:"updateVirtualDOM",value:function(){var e=this;return new Promise(function(t){e.needUpdateVirtualDOM.call(e.context,[].concat(e._vElements),function(){return t()})})}},{key:"addVirtualElement",value:function(e,t,n,r){this._vElements&&this._vElements.push(this.createVirtualElement(e,t,n,r))}},{key:"removeVirtualElementForCell",value:function(e){if(this._vElements){var t=this._vElements.findIndex(function(t){return t.element===e.__element});return t>-1?(this._vElements.splice(t,1),!0):void 0}}},{key:"sortVirtualElements",value:function(){this._vElements&&this._vElements.sort(function(e,t){return e.index<t.index?-1:1})}},{key:"replaceVirtualElementForCell",value:function(e,t,n,r,i){this._vElements&&this._vElements.splice([].slice.call(this.getCells()).indexOf(t),1,this.createVirtualElement(e,n,r,i))}},{key:"createVirtualElement",value:function(e,t,n,r){return{element:e,index:t,isExpanded:n,level:r}}},{key:"syncVDOMToInternalState",value:function(){var e=Bt(a.mark(function e(){var t,n,r,i,o,s,l,u,c=this;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if((t=this._vElements.slice(0).sort(function(e,t){return e.index-t.index})).length){e.next=6;break}return e.next=4,this.updateVirtualDOM();case 4:return this.updateCellsSorted(),e.abrupt("return");case 6:if(n=t[0].index,r=this.getCellsSorted().find(function(e){return e.__index===n})){e.next=10;break}return e.abrupt("return");case 10:return i=this.getNodeTop(r),e.next=13,this.updateVirtualDOM();case 13:for(o=this.getCells(),s=0;s<o.length;s++)l=o[s],u=this._vElements[s],l.__index=u.index,l.__element=u.element,l.__level=u.level,l.dataset.level=u.level;this.updateCellsSorted().reduce(function(e,t){return c.setNodeTop(t,e),c.setNodeHeight(t),e+c.getNodeHeight(t)},i);case 16:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"getNodeHeight",value:function(e,t){return e?t||!e.__nodeHeight?this.setNodeHeight(e,t):e.__nodeHeight||0:0}},{key:"setNodeHeight",value:function(e,t,n,r){return n=Math.max(n,0),r&&(e.style.height=n+"px"),e.__nodeHeight=n||t?e.getBoundingClientRect().height:e.offsetHeight,e.__nodeHeight}},{key:"getNodeTop",value:function(e){return e&&e&&e.__nodeTop||0}},{key:"setNodeTop",value:function(e,t){return t=Math.max(t,0),this.useTransform?e.style.transform="translateY("+t+"px)":e.style.top=t+"px",e.__nodeTop=t,e.__nodeTop}},{key:"getNodeBottom",value:function(e){return e?this.getNodeTop(e)+this.getNodeHeight(e):0}},{key:"getMinimumListNodeHeight",value:function(){var e=this.getNodeHeight(this._scrollNode,!0);return e+e*(2*this.thresholdRatio)}},{key:"updateListBounds",value:function(e){if(this._cellsSorted&&this._cellsSorted.length){var t=this._cellsSorted[this._cellsSorted.length-1],n=this.getNodeBottom(t),r=this.getNodeHeight(this._listNode),i=Math.ceil(this._scrollNode.scrollHeight-this.getScrollPosition())===this.getNodeHeight(this._scrollNode),o=t.__index===this._currentMaxIndex&&n-r!=0;(e||i||o||!r)&&this.setNodeHeight(this._listNode,!1,n+(this._currentMaxIndex-t.__index)*this._averageCellHeight,!0)}}},{key:"getTopRenderThreshold",value:function(){return-this.getNodeHeight(this._scrollNode)*this.thresholdRatio}},{key:"getBottomRenderThreshold",value:function(){var e=this.getNodeHeight(this._scrollNode);return e*this.thresholdRatio+e}},{key:"getCells",value:function(){return this._listNode?this._listNode.children:void 0}},{key:"getCellsSorted",value:function(){return this._cellsSorted?this._cellsSorted:this.updateCellsSorted()}},{key:"updateCellsSorted",value:function(){var e=this.getCells();if(e)return this._cellsSorted=[].slice.call(e),this._cellsSorted.sort(function(e,t){return e.__index-t.__index}),this._cellsSorted}},{key:"addEventListener",value:function(e,t){return this._events[e]=this._events[e]||[],this._events[e].push(t),this}},{key:"removeEventListener",value:function(e,t){if(this._events[e]){var n=this._events[e].indexOf(t);n>-1&&this._events[e].splice(n,1)}}},{key:"emitEvent",value:function(e){var t=this,n=this._events[e],r=[].slice.call(arguments,1);n&&n.length>0&&n.forEach(function(e){return e.apply(t,r)}),this[e]&&this[e].apply(this.context,r)}},{key:"emitElementEvents",value:function(e,t){0===t&&this.emitEvent("didRenderFirstElement",e,this),t===this._currentMaxIndex&&this.emitEvent("didRenderLastElement",e,this)}},{key:"getScrollPosition",value:function(){return this._scrollNode?this._scrollNode.scrollTop:void 0}},{key:"setScrollPosition",value:function(e){this._scrollNode&&(this._scrollNode.scrollTop=e)}},{key:"initScrollListener",value:function(){var e=this;this._scrollNode&&this._scrollNode.addEventListener("scroll",function(t){return e.rUpdateCells()})}},{key:"scrollToFirstElement",value:function(){var e=Bt(a.mark(function e(){var t;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getElementAndLevelAtIndex(0),e.next=3,this.scrollToElement(t.element);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"scrollToLastElement",value:function(){var e=Bt(a.mark(function e(){var t;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getElementAndLevelAtIndex(this._currentMaxIndex),e.next=3,this.scrollToElement(t.element);case 3:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"scrollToElement",value:function(){var e=Bt(a.mark(function e(t,n){var r,i,o,s,l,u;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r=qt({smooth:!1,nearest:!1,bottom:!1,force:!1,offset:0},n),i=this._cellsSorted.find(function(e){return e.__element===t})){e.next=5;break}return e.next=5,this.updateCells();case 5:if(!i){e.next=12;break}return o=this.getNodeTop(i)>this.getScrollPosition()&&this.getNodeBottom(i)<this.getScrollPosition()+this.getNodeHeight(this._scrollNode),!r.force&&o||(s=r.bottom||r.nearest&&this.getNodeTop(i)>this.getScrollPosition()+this.getNodeHeight(this._scrollNode)/2,l=s?this.getNodeTop(i)-this.getNodeHeight(this._scrollNode)+this.getNodeHeight(i)+r.offset:this.getNodeTop(i)+r.offset,this.setScrollPosition(l)),delete this._cachedScrollToElement,delete this._cachedScrollToOptions,delete this._initialScrollToElement,e.abrupt("return");case 12:if(!((u=this.getIndexForElement(t))<0)){e.next=15;break}return e.abrupt("return");case 15:if(this._cachedScrollToElement=t,this._cachedScrollToOptions=r,0!==this._cellsSorted.length){e.next=19;break}return e.abrupt("return");case 19:this.setScrollPosition(u*this._averageCellHeight);case 20:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"scrollToCachedScrollElement",value:function(){var e=Bt(a.mark(function e(){return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._cachedScrollToElement){e.next=5;break}return e.next=3,this.scrollToElement(this._cachedScrollToElement,this._cachedScrollToOptions);case 3:e.next=6;break;case 5:case 6:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"needUpdate",value:function(){return this._data=this.getData?this.getData.call(this.context,this):[],this.updateCurrentMaxIndex(),this.invalidateExpandInformations(),this}},{key:"update",value:function(e,t){return this.needUpdate(),this.rUpdateCells(!0,e,t),this}},{key:"restoreState",value:function(){var e=Bt(a.mark(function e(t,n){return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.needUpdate(),this._scrollNode||(this.renderScrollNode(n||this.parentNode),this.renderListNode(),this.initScrollListener()),-1!==this._currentMaxIndex){e.next=4;break}return e.abrupt("return");case 4:return e.next=6,this.addCell(t.index,t.position);case 6:e.sent&&(this.setNodeHeight(this._listNode,!1,t.height,!0),this.setScrollPosition(t.scrollTop)),delete this._initialScrollToElement,delete this._cachedScrollToElement,this.updateCellsAverages(),this.updateCells();case 12:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"getElementAndLevelAtIndex",value:function(e){if(!this.canHasChildren())return this.createElementAndLevelInformation(this._data[e],0);for(var t=0,n=this._expandInformations.length-1;n>=0;n--){var r=this._expandInformations[n];if(r.active&&!(r.index>=e)&&(t+=r.elementChildren.length,!(r.index+t<e))){var i=e-(r.index+t-r.elementChildren.length)-1;return this.createElementAndLevelInformation(r.elementChildren[i],r.level)}}return this.createElementAndLevelInformation(this._data[e-t],0)}},{key:"createElementAndLevelInformation",value:function(e,t){return{element:e,level:t}}},{key:"updateCurrentMaxIndex",value:function(){var e=this._expandInformations.reduce(function(e,t){return e+(t.active?t.elementChildren.length:0)},0);this._currentMaxIndex=this._data.length-1+e}},{key:"canHasChildren",value:function(){return void 0!==this.getElementChildren}},{key:"getChildrenForElement",value:function(e){return this.canHasChildren()?this.getElementChildren.call(this.context,e,this):void 0}},{key:"getIndexForElement",value:function(e){var t=this,n=this._data.indexOf(e);return n>-1?this._expandInformations.reduce(function(e,r){return r.elementParent?e:(t._data.indexOf(r.element)<n&&(e+=r.totalLength),e)},n):this._expandInformations.reduce(function(n,r){if(n>-1)return n;var i=r.elementChildren.indexOf(e);return i>-1&&(n=i+r.index+1+r.elementChildren.reduce(function(e,n,r){if(r>=i)return e;var o=t._expandInformations.find(function(e){return e.element===n});return o&&(e+=o.totalLength),e},0)),n},-1)}},{key:"maintainCellCount",value:function(){var e=Bt(a.mark(function e(){var t,n,r,i,o,s,l,u,c,h,d,f;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=this.getScrollPosition(),n=t+this.getTopRenderThreshold(),r=t+this.getBottomRenderThreshold(),i=this.getCellsSorted(),o=i[0],s=i[i.length-1],l=this.getNodeBottom(s)-this.getNodeTop(o),u=this.getMinimumListNodeHeight(),c=u>l,h=!1,e.t0=!0,e.next=e.t0===(!o&&this._currentMaxIndex>-1)?13:e.t0===(s&&s.__index<this._currentMaxIndex&&(c||this.getNodeBottom(s)<r))?19:e.t0===(o&&o.__index>0&&(c||this.getNodeTop(o)>n))?23:e.t0===(o&&(o.__index<0||this.getNodeBottom(o)<n&&l-this.getNodeHeight(o)>u))?27:e.t0===(s&&(s.__index>this._currentMaxIndex||this.getNodeTop(s)>r&&l-this.getNodeHeight(s)>u))?31:35;break;case 13:return d=this._initialScrollToElement?this.getIndexForElement(this._initialScrollToElement):0,e.next=16,this.addCell(d,0);case 16:return(f=e.sent)&&(this.setNodeTop(f,this.getNodeHeight(f)*d),h=!0),e.abrupt("break",35);case 19:return e.next=21,this.addCell(s.__index+1,this.getNodeBottom(s));case 21:return h=!!e.sent,e.abrupt("break",35);case 23:return e.next=25,this.addCell(o.__index-1,this.getNodeTop(o),!0);case 25:return h=!!e.sent,e.abrupt("break",35);case 27:return e.next=29,this.removeCell(o);case 29:return h=!!e.sent,e.abrupt("break",35);case 31:return e.next=33,this.removeCell(s);case 33:return h=!!e.sent,e.abrupt("break",35);case 35:if(!h){e.next=46;break}if(this.updateCellsSorted(),this.updateCellsAverages(),this.updateListBounds(),!this._initialScrollToElement){e.next=42;break}return e.next=42,this.scrollToCachedScrollElement();case 42:return e.next=44,this.updateCells();case 44:return e.next=46,this.maintainCellCount();case 46:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"addCell",value:function(){var e=Bt(a.mark(function e(t,n){var r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t<0||t>this._currentMaxIndex)){e.next=2;break}return e.abrupt("return");case 2:if(!this.virtualEnvironment){e.next=8;break}return e.next=5,this.updateCell(void 0,t);case 5:e.t0=e.sent,e.next=11;break;case 8:return e.next=10,this.updateCell(this.renderCell(),t);case 10:e.t0=e.sent;case 11:if(r=e.t0){e.next=14;break}return e.abrupt("return");case 14:return r.__frameNode=this.virtualEnvironment&&this.observeCellBounds?this.renderIFrame(r,this.onResizeCell):r.__frameNode,this.setNodeHeight(r),this.setNodeTop(r,n-(i?this.getNodeHeight(r):0)),e.abrupt("return",r);case 18:case"end":return e.stop()}},e,this)}));return function(t,n){return e.apply(this,arguments)}}()},{key:"removeCell",value:function(){var e=Bt(a.mark(function e(t){var n;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.virtualEnvironment){e.next=5;break}return n=this.removeVirtualElementForCell(t),e.next=4,this.syncVDOMToInternalState();case 4:return e.abrupt("return",n);case 5:return this._listNode.removeChild(t),e.abrupt("return",!0);case 7:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}()},{key:"rUpdateCells",value:function(e,t,n){this.rAF(this.updateCells,"updatecells",e,t,n)}},{key:"updateCells",value:function(){var e=Bt(a.mark(function e(t,n,r){var i,o,s,l,u,c,h,d,f,v,p,m,_,g,x,y;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._updatingCells){e.next=2;break}return e.abrupt("return");case 2:this._updatingCells=!0,i=this.getScrollPosition(),o=i+this.getTopRenderThreshold(),s=i+this.getBottomRenderThreshold(),l=this.getCellsSorted().slice(0),u=t,c={},h=!1,t&&(c.index=0,c.pos=0,r?(d=this.findCellIndexDeviation(),f=d*this._averageCellHeight,c.index=Math.max(0,l&&l.length?l[0].__index+d:0),c.pos=Math.max(0,this.getNodeTop(l[0])+f),this.updateListBounds(!0),this.setScrollPosition(i+f)):this.setScrollPosition(0)),l&&l.length&&(this.getNodeTop(l[0])>s||this.getNodeBottom(l[l.length-1])<o)&&(t=!0,c.index=Math.min(Math.round(Math.max(o,0)/this._averageCellHeight),this._currentMaxIndex-l.length+1),c.pos=Math.max(0,c.index*this._averageCellHeight+this.getTopRenderThreshold())),v=0;case 13:if(!(v<l.length)){e.next=66;break}if(p=l[0],m=l[l.length-1],_=l[v],!t){e.next=29;break}return g=0===_.__index&&c.index>0?this.getNodeHeight(_):0,e.next=21,this.updateCell(_,c.index,n);case 21:this.setNodeHeight(_),c.pos+=g?g-this.getNodeHeight(_):0,this.setNodeTop(_,c.pos),c.index+=1,c.pos+=this.getNodeHeight(_),h=!0,e.next=63;break;case 29:if(!(m.__index<this._currentMaxIndex&&this.getNodeBottom(_)<o&&this.getNodeBottom(m)<s)){e.next=38;break}return e.next=32,this.updateCell(_,m.__index+1,n);case 32:this.setNodeHeight(_),this.setNodeTop(_,this.getNodeBottom(m)),l.push(l.shift()),h=!0,e.next=63;break;case 38:if(!(v===l.length-1&&p.__index>0&&this.getNodeTop(_)>s&&this.getNodeTop(p)>o)){e.next=63;break}return e.next=41,this.updateCell(_,p.__index-1,n);case 41:this.setNodeHeight(_),this.setNodeTop(_,this.getNodeTop(p)-this.getNodeHeight(_)),l.unshift(l.pop()),h=!0,e.t0=!0,e.next=e.t0===(0===_.__index&&this.getNodeTop(_)>0)?48:e.t0===(0===this.getNodeTop(_))?55:62;break;case 48:return x=this.getNodeTop(_),t=!0,c.index=_.__index,c.pos=0,this.setScrollPosition(i-x),v=-1,e.abrupt("break",63);case 55:return y=this._averageCellHeight*_.__index,t=!0,c.index=_.__index,c.pos=y,this.setScrollPosition(i+y),v=-1,e.abrupt("break",63);case 62:v--;case 63:v++,e.next=13;break;case 66:if(l&&l.length&&!h){e.next=72;break}return this.updateCellsSorted(),e.next=70,this.maintainCellCount();case 70:this.updateCellsAverages(),this.emitEvent("cellsUpdated",this.getCellsSorted(),this);case 72:this.updateListBounds(u),this.scrollToCachedScrollElement(),this.updateFirstAndLastCellInViewport(),this._updatingCells=!1;case 76:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"updateCell",value:function(){var e=Bt(a.mark(function e(t,n,r){var i,o,s,l,u,c;return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getElementAndLevelAtIndex(n)){e.next=3;break}return e.abrupt("return");case 3:if(o=i.element,s=i.level,o&&(!t||o!==t.__element||r)){e.next=8;break}return t&&o===t.__element&&(t.__index=n,t.__level=s,t.dataset.level=s),e.abrupt("return");case 8:if(l=this.canHasChildren()?this.getExpandInformationForElement(o):void 0,t&&this.disableNodeResizeObserving(t),this.virtualEnvironment){e.next=15;break}"string"==typeof(u=this.getCellRenderer?this.getCellRenderer.call(this.context,o,n,void 0!==l,this):"")||u instanceof String?t.__contentNode.innerHTML=u:(t.__contentNode.innerHTML="",t.__contentNode.appendChild(u)),e.next=19;break;case 15:return t?this.replaceVirtualElementForCell(o,t,n,void 0!==l,s):this.addVirtualElement(o,n,void 0!==l,s),e.next=18,this.updateVirtualDOM();case 18:t||(c=this.getCells(),t=c[c.length-1]);case 19:return this.observeCellBounds&&this.rAF(this.enableNodeResizeObserving,!1,t),l?t.classList.add("expanded"):t.classList.remove("expanded"),t.dataset.level=s,t.__element=o,t.__index=n,t.__level=s,this.emitElementEvents(o,n),e.abrupt("return",t);case 27:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"findCellIndexDeviation",value:function(){for(var e=0;e<this._cellsSorted.length;e++){var t=this._cellsSorted[e],n=this.getIndexForElement(t.__element);if(-1!==n)return n===t.__index?0:n-t.__index}return 0}},{key:"updateCellsAverages",value:function(){var e=this.getCells(),t=0;this._lowestCellHeight=Number.MAX_VALUE;for(var n=0;n<e.length;n++){var r=this.getNodeHeight(e[n]);t+=r,this._lowestCellHeight=0===this._lowestCellHeight?r:Math.min(this._lowestCellHeight,r)}this._averageCellHeight=t/e.length}},{key:"cellBoundsUpdated",value:function(){this.rUpdateCells(!0,!1,!0)}},{key:"updateFirstAndLastCellInViewport",value:function(){for(var e=this.getScrollPosition(),t=this.getNodeHeight(this._scrollNode),n=this.getCellsSorted(),r=e+t,i=Math.max(1,Math.round(n.length/5)),o=-1,s=-1,a=0;a<n.length;a+=i){var l=n[a];if(this.getNodeTop(l)>e){o=Math.max(0,a-i);break}}if(o>-1){for(;;){var u=n[o];if(this.getNodeTop(u)>=e)break;o++}for(s=o;;){var c=n[s];if(!c||this.getNodeTop(c)+this.getNodeHeight(c)>=r){s--;break}s++}if(o<0||s<0)return;var h=n[o].__element,d=n[s].__element;h!==this._firstInBoundsElement&&(this._firstInBoundsElement=h,this.emitEvent("firstInBoundsElementChanged",this._firstInBoundsElement,this)),d!==this._lastInBoundsElement&&(this._lastInBoundsElement=d,this.emitEvent("lastInBoundsElementChanged",this._lastInBoundsElement,this))}}},{key:"onResizeScrollNode",value:function(e){var t=this;this.disableAllCellsResizeObserving(),this.rAF(Bt(a.mark(function e(){return a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.updateCells(!0,!1,!0);case 2:t.setNodeHeight(t._scrollNode),t.enableAllCellsResizeObserving();case 4:case"end":return e.stop()}},e,t)})),"resizelist")}},{key:"onResizeCell",value:function(e){this.cellBoundsUpdated()}},{key:"disableNodeResizeObserving",value:function(e){e.__frameNode&&e.__frameNode.contentWindow&&e.__frameNode.contentWindow.onresize&&(e.__frameNode.contentWindow.__onresize=e.__frameNode.contentWindow.onresize,e.__frameNode.contentWindow.onresize=void 0)}},{key:"enableNodeResizeObserving",value:function(e){this.observeCellBounds&&e.__frameNode&&e.__frameNode.contentWindow&&e.__frameNode.contentWindow.__onresize&&(e.__frameNode.contentWindow.onresize=e.__frameNode.contentWindow.__onresize,e.__frameNode.contentWindow.__onresize=void 0)}},{key:"disableAllCellsResizeObserving",value:function(){var e=this;this.observeCellBounds&&this.getCellsSorted().forEach(function(t){return e.disableNodeResizeObserving(t)})}},{key:"enableAllCellsResizeObserving",value:function(){var e=this;this.observeCellBounds&&this.getCellsSorted().forEach(function(t){return e.enableNodeResizeObserving(t)})}},{key:"isElementExpanded",value:function(e){return void 0!==this.getExpandInformationForElement(e)}},{key:"expandElement",value:function(e){this.addExpandInformationForElement(e),this.updateCells(!0,!1,!0)}},{key:"collapseElement",value:function(e){this.removeExpandInformationForElement(e),this.updateCells(!0,!1,!0)}},{key:"toggleExpandElement",value:function(e){this.isElementExpanded(e)?this.collapseElement(e):this.expandElement(e)}},{key:"getExpandInformationForElement",value:function(e){return this._expandInformations.find(function(t){return t.element===e})}},{key:"getExpandInformationForElementParent",value:function(e){return this._expandInformations.find(function(t){return t.elementChildren.indexOf(e)>-1})}},{key:"createExpandInformation",value:function(e){var t=this.getExpandInformationForElementParent(e);return{active:!0,element:e,elementIndex:t?t.elementChildren.indexOf(e):this._data.indexOf(e),elementChildren:this.getChildrenForElement(e),elementParent:t?t.element:void 0,index:this.getIndexForElement(e),level:t?t.level+1:1,totalLength:0}}},{key:"addExpandInformationForElement",value:function(e){var t=this.createExpandInformation(e);if(this._expandInformations.push(t),this.invalidateExpandInformations(),this.rememberChildrenExpands)for(var n=this._expandInformations.indexOf(t)+1;n<this._expandInformations.length;n++){var r=this._expandInformations[n],i=this._expandInformations[n-1];i.active&&i.element===r.elementParent&&(r.active=!0)}this.invalidateExpandInformations()}},{key:"removeExpandInformationForElement",value:function(e){for(var t=this.getExpandInformationForElement(e),n=[t],r=this._expandInformations.indexOf(t)+1;r<this._expandInformations.length;r++){var i=this._expandInformations[r];if(i.level<=t.level)break;n.push(i)}for(var o=0;o<n.length;o++){var s=n[o];s===t?this.removeElementFromArray(this._expandInformations,s):this.rememberChildrenExpands?s.active=!1:this.removeElementFromArray(this._expandInformations,s)}this.invalidateExpandInformations()}},{key:"invalidateExpandInformations",value:function(){this._expandInformations.sort(function(e,t){return e.index-t.index});for(var e=[],t=0;t<this._expandInformations.length;t++){for(var n=this._expandInformations[t],r=n.elementParent?this.getChildrenForElement(n.elementParent):this._data,i=!1,o=0;o<e.length;o++)i=e[o].element===n.elementParent||i;i||-1===r.indexOf(n.element)?(n.elementChildren=[],e.push(n)):n.elementChildren=this.getChildrenForElement(n.element)}for(var s=0;s<e.length;s++)this.removeElementFromArray(this._expandInformations,e[s]);this.calculateExpandInformationIndexes()}},{key:"calculateExpandInformationIndexes",value:function(){for(var e=[],t=void 0,n=0,r=0;r<this._expandInformations.length;r++){var i=this._expandInformations[r];if(i.active){t&&(i.level>t.level&&e.push(t),i.level<t.level&&(e=e.slice(0,e.length-(t.level-i.level)))),i.totalLength=i.elementChildren.length;for(var o=0;o<e.length;o++)e[o].totalLength+=i.totalLength;var s=e.length>0?e[e.length-1]:void 0,a=s?s.index:void 0,l=s?s.totalLength-i.totalLength:0,u=s?s.elementChildren.length:0,c=e&&e.length>0?e[e.length-1].elementChildren.indexOf(i.element):this._data.indexOf(i.element),h=l-u+c+(void 0!==a?a+1:0)+(1===i.level?n:0);i.elementIndex=c,i.index=h,t=i,n+=i.elementChildren.length}}this.updateCurrentMaxIndex()}},{key:"rAF",value:function(e,t){var n=this,r=[].slice.call(arguments,2);this.virtualEnvironment?e.apply(this,r):t?(this._frameRequests[t]&&window.cancelAnimationFrame(this._frameRequests[t]),this._frameRequests[t]=window.requestAnimationFrame(function(){e.apply(n,r),delete n._frameRequests[t]})):window.requestAnimationFrame(function(){return e.apply(n,r)})}},{key:"removeElementFromArray",value:function(e,t){var n=e?e.indexOf(t):-1;return n>-1?e.splice(n,1):void 0}}]),e}()});
