!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.MNSTR=t()}(this,function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var n=t(function(e){!function(t){var n,r=Object.prototype,i=r.hasOwnProperty,o="function"==typeof Symbol?Symbol:{},s=o.iterator||"@@iterator",l=o.asyncIterator||"@@asyncIterator",a=o.toStringTag||"@@toStringTag",u=t.regeneratorRuntime;if(u)e.exports=u;else{(u=t.regeneratorRuntime=e.exports).wrap=y;var c="suspendedStart",h="suspendedYield",d="executing",f="completed",v={},p={};p[s]=function(){return this};var m=Object.getPrototypeOf,_=m&&m(m(T([])));_&&_!==r&&i.call(_,s)&&(p=_);var g=C.prototype=E.prototype=Object.create(p);b.prototype=g.constructor=C,C.constructor=b,C[a]=b.displayName="GeneratorFunction",u.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===b||"GeneratorFunction"===(t.displayName||t.name))},u.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,C):(e.__proto__=C,a in e||(e[a]="GeneratorFunction")),e.prototype=Object.create(g),e},u.awrap=function(e){return{__await:e}},k(N.prototype),N.prototype[l]=function(){return this},u.AsyncIterator=N,u.async=function(e,t,n,r){var i=new N(y(e,t,n,r));return u.isGeneratorFunction(t)?i:i.next().then(function(e){return e.done?e.value:i.next()})},k(g),g[a]="Generator",g[s]=function(){return this},g.toString=function(){return"[object Generator]"},u.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},u.values=T,L.prototype={constructor:L,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(I),!e)for(var t in this)"t"===t.charAt(0)&&i.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=n)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(r,i){return l.type="throw",l.arg=e,t.next=r,i&&(t.method="next",t.arg=n),!!i}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],l=s.completion;if("root"===s.tryLoc)return r("end");if(s.tryLoc<=this.prev){var a=i.call(s,"catchLoc"),u=i.call(s,"finallyLoc");if(a&&u){if(this.prev<s.catchLoc)return r(s.catchLoc,!0);if(this.prev<s.finallyLoc)return r(s.finallyLoc)}else if(a){if(this.prev<s.catchLoc)return r(s.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return r(s.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),v},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),I(n),v}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;I(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,r){return this.delegate={iterator:T(e),resultName:t,nextLoc:r},"next"===this.method&&(this.arg=n),v}}}function y(e,t,n,r){var i=t&&t.prototype instanceof E?t:E,o=Object.create(i.prototype),s=new L(r||[]);return o._invoke=function(e,t,n){var r=c;return function(i,o){if(r===d)throw new Error("Generator is already running");if(r===f){if("throw"===i)throw o;return O()}for(n.method=i,n.arg=o;;){var s=n.delegate;if(s){var l=w(s,n);if(l){if(l===v)continue;return l}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(r===c)throw r=f,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r=d;var a=x(e,t,n);if("normal"===a.type){if(r=n.done?f:h,a.arg===v)continue;return{value:a.arg,done:n.done}}"throw"===a.type&&(r=f,n.method="throw",n.arg=a.arg)}}}(e,n,s),o}function x(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}function E(){}function b(){}function C(){}function k(e){["next","throw","return"].forEach(function(t){e[t]=function(e){return this._invoke(t,e)}})}function N(e){var t;this._invoke=function(n,r){function o(){return new Promise(function(t,o){!function t(n,r,o,s){var l=x(e[n],e,r);if("throw"!==l.type){var a=l.arg,u=a.value;return u&&"object"==typeof u&&i.call(u,"__await")?Promise.resolve(u.__await).then(function(e){t("next",e,o,s)},function(e){t("throw",e,o,s)}):Promise.resolve(u).then(function(e){a.value=e,o(a)},s)}s(l.arg)}(n,r,t,o)})}return t=t?t.then(o,o):o()}}function w(e,t){var r=e.iterator[t.method];if(r===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=n,w(e,t),"throw"===t.method))return v;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var i=x(r,e.iterator,t.arg);if("throw"===i.type)return t.method="throw",t.arg=i.arg,t.delegate=null,v;var o=i.arg;return o?o.done?(t[e.resultName]=o.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=n),t.delegate=null,v):o:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,v)}function S(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function I(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function L(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(S,this),this.reset(!0)}function T(e){if(e){var t=e[s];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(i.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=n,t.done=!0,t};return o.next=o}}return{next:O}}function O(){return{value:n,done:!0}}}(function(){return this}()||Function("return this")())}),r=function(){return this}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=i&&r.regeneratorRuntime;r.regeneratorRuntime=void 0;var s=n;if(i)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(e){r.regeneratorRuntime=void 0}var l=s,a=Math.ceil,u=Math.floor,c=function(e){return isNaN(e=+e)?0:(e>0?u:a)(e)},h=function(e){if(null==e)throw TypeError("Can't call method on  "+e);return e},d=t(function(e){var t=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)}),f=t(function(e){var t=e.exports={version:"2.5.7"};"number"==typeof __e&&(__e=t)}),v=(f.version,function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}),p=function(e,t,n){if(v(e),void 0===t)return e;switch(n){case 1:return function(n){return e.call(t,n)};case 2:return function(n,r){return e.call(t,n,r)};case 3:return function(n,r,i){return e.call(t,n,r,i)}}return function(){return e.apply(t,arguments)}},m=function(e){return"object"==typeof e?null!==e:"function"==typeof e},_=function(e){if(!m(e))throw TypeError(e+" is not an object!");return e},g=function(e){try{return!!e()}catch(e){return!0}},y=!g(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),x=d.document,E=m(x)&&m(x.createElement),b=function(e){return E?x.createElement(e):{}},C=!y&&!g(function(){return 7!=Object.defineProperty(b("div"),"a",{get:function(){return 7}}).a}),k=Object.defineProperty,N={f:y?Object.defineProperty:function(e,t,n){if(_(e),t=function(e,t){if(!m(e))return e;var n,r;if(t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;if("function"==typeof(n=e.valueOf)&&!m(r=n.call(e)))return r;if(!t&&"function"==typeof(n=e.toString)&&!m(r=n.call(e)))return r;throw TypeError("Can't convert object to primitive value")}(t,!0),_(n),C)try{return k(e,t,n)}catch(e){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(e[t]=n.value),e}},w=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}},S=y?function(e,t,n){return N.f(e,t,w(1,n))}:function(e,t,n){return e[t]=n,e},I={}.hasOwnProperty,L=function(e,t){return I.call(e,t)},T=function(e,t,n){var r,i,o,s=e&T.F,l=e&T.G,a=e&T.S,u=e&T.P,c=e&T.B,h=e&T.W,v=l?f:f[t]||(f[t]={}),m=v.prototype,_=l?d:a?d[t]:(d[t]||{}).prototype;for(r in l&&(n=t),n)(i=!s&&_&&void 0!==_[r])&&L(v,r)||(o=i?_[r]:n[r],v[r]=l&&"function"!=typeof _[r]?n[r]:c&&i?p(o,d):h&&_[r]==o?function(e){var t=function(t,n,r){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,n)}return new e(t,n,r)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(o):u&&"function"==typeof o?p(Function.call,o):o,u&&((v.virtual||(v.virtual={}))[r]=o,e&T.R&&m&&!m[r]&&S(m,r,o)))};T.F=1,T.G=2,T.S=4,T.P=8,T.B=16,T.W=32,T.U=64,T.R=128;var O,P=T,M=S,F={},R={}.toString,A=function(e){return R.call(e).slice(8,-1)},H=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==A(e)?e.split(""):Object(e)},j=function(e){return H(h(e))},B=Math.min,z=function(e){return e>0?B(c(e),9007199254740991):0},V=Math.max,D=Math.min,W=t(function(e){var t=d["__core-js_shared__"]||(d["__core-js_shared__"]={});(e.exports=function(e,n){return t[e]||(t[e]=void 0!==n?n:{})})("versions",[]).push({version:f.version,mode:"pure",copyright:"© 2018 Denis Pushkarev (zloirock.ru)"})}),U=0,G=Math.random(),q=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++U+G).toString(36))},Y=W("keys"),X=function(e){return Y[e]||(Y[e]=q(e))},K=(O=!1,function(e,t,n){var r,i=j(e),o=z(i.length),s=function(e,t){return(e=c(e))<0?V(e+t,0):D(e,t)}(n,o);if(O&&t!=t){for(;o>s;)if((r=i[s++])!=r)return!0}else for(;o>s;s++)if((O||s in i)&&i[s]===t)return O||s||0;return!O&&-1}),J=X("IE_PROTO"),Q="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(","),Z=Object.keys||function(e){return function(e,t){var n,r=j(e),i=0,o=[];for(n in r)n!=J&&L(r,n)&&o.push(n);for(;t.length>i;)L(r,n=t[i++])&&(~K(o,n)||o.push(n));return o}(e,Q)},$=y?Object.defineProperties:function(e,t){_(e);for(var n,r=Z(t),i=r.length,o=0;i>o;)N.f(e,n=r[o++],t[n]);return e},ee=d.document,te=ee&&ee.documentElement,ne=X("IE_PROTO"),re=function(){},ie=function(){var e,t=b("iframe"),n=Q.length;for(t.style.display="none",te.appendChild(t),t.src="javascript:",(e=t.contentWindow.document).open(),e.write("<script>document.F=Object<\/script>"),e.close(),ie=e.F;n--;)delete ie.prototype[Q[n]];return ie()},oe=Object.create||function(e,t){var n;return null!==e?(re.prototype=_(e),n=new re,re.prototype=null,n[ne]=e):n=ie(),void 0===t?n:$(n,t)},se=t(function(e){var t=W("wks"),n=d.Symbol,r="function"==typeof n;(e.exports=function(e){return t[e]||(t[e]=r&&n[e]||(r?n:q)("Symbol."+e))}).store=t}),le=N.f,ae=se("toStringTag"),ue=function(e,t,n){e&&!L(e=n?e:e.prototype,ae)&&le(e,ae,{configurable:!0,value:t})},ce={};S(ce,se("iterator"),function(){return this});var he,de=function(e,t,n){e.prototype=oe(ce,{next:w(1,n)}),ue(e,t+" Iterator")},fe=function(e){return Object(h(e))},ve=X("IE_PROTO"),pe=Object.prototype,me=Object.getPrototypeOf||function(e){return e=fe(e),L(e,ve)?e[ve]:"function"==typeof e.constructor&&e instanceof e.constructor?e.constructor.prototype:e instanceof Object?pe:null},_e=se("iterator"),ge=!([].keys&&"next"in[].keys()),ye=function(){return this},xe=function(e,t,n,r,i,o,s){de(n,t,r);var l,a,u,c=function(e){if(!ge&&e in v)return v[e];switch(e){case"keys":case"values":return function(){return new n(this,e)}}return function(){return new n(this,e)}},h=t+" Iterator",d="values"==i,f=!1,v=e.prototype,p=v[_e]||v["@@iterator"]||i&&v[i],m=p||c(i),_=i?d?c("entries"):m:void 0,g="Array"==t&&v.entries||p;if(g&&(u=me(g.call(new e)))!==Object.prototype&&u.next&&ue(u,h,!0),d&&p&&"values"!==p.name&&(f=!0,m=function(){return p.call(this)}),s&&(ge||f||!v[_e])&&S(v,_e,m),F[t]=m,F[h]=ye,i)if(l={values:d?m:c("values"),keys:o?m:c("keys"),entries:_},s)for(a in l)a in v||M(v,a,l[a]);else P(P.P+P.F*(ge||f),t,l);return l},Ee=(he=!0,function(e,t){var n,r,i=String(h(e)),o=c(t),s=i.length;return o<0||o>=s?he?"":void 0:(n=i.charCodeAt(o))<55296||n>56319||o+1===s||(r=i.charCodeAt(o+1))<56320||r>57343?he?i.charAt(o):n:he?i.slice(o,o+2):r-56320+(n-55296<<10)+65536});xe(String,"String",function(e){this._t=String(e),this._i=0},function(){var e,t=this._t,n=this._i;return n>=t.length?{value:void 0,done:!0}:(e=Ee(t,n),this._i+=e.length,{value:e,done:!1})});var be=function(e,t){return{value:t,done:!!e}};xe(Array,"Array",function(e,t){this._t=j(e),this._i=0,this._k=t},function(){var e=this._t,t=this._k,n=this._i++;return!e||n>=e.length?(this._t=void 0,be(1)):be(0,"keys"==t?n:"values"==t?e[n]:[n,e[n]])},"values");F.Arguments=F.Array;for(var Ce=se("toStringTag"),ke="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(","),Ne=0;Ne<ke.length;Ne++){var we=ke[Ne],Se=d[we],Ie=Se&&Se.prototype;Ie&&!Ie[Ce]&&S(Ie,Ce,we),F[we]=F.Array}var Le,Te,Oe,Pe=se("toStringTag"),Me="Arguments"==A(function(){return arguments}()),Fe=function(e){var t,n,r;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(n=function(e,t){try{return e[t]}catch(e){}}(t=Object(e),Pe))?n:Me?A(t):"Object"==(r=A(t))&&"function"==typeof t.callee?"Arguments":r},Re=function(e,t,n,r){try{return r?t(_(n)[0],n[1]):t(n)}catch(t){var i=e.return;throw void 0!==i&&_(i.call(e)),t}},Ae=se("iterator"),He=Array.prototype,je=se("iterator"),Be=f.getIteratorMethod=function(e){if(null!=e)return e[je]||e["@@iterator"]||F[Fe(e)]},ze=t(function(e){var t={},n={},r=e.exports=function(e,r,i,o,s){var l,a,u,c,h,d=s?function(){return e}:Be(e),f=p(i,o,r?2:1),v=0;if("function"!=typeof d)throw TypeError(e+" is not iterable!");if(void 0===(h=d)||F.Array!==h&&He[Ae]!==h){for(u=d.call(e);!(a=u.next()).done;)if((c=Re(u,f,a.value,r))===t||c===n)return c}else for(l=z(e.length);l>v;v++)if((c=r?f(_(a=e[v])[0],a[1]):f(e[v]))===t||c===n)return c};r.BREAK=t,r.RETURN=n}),Ve=se("species"),De=function(e,t){var n,r=_(e).constructor;return void 0===r||null==(n=_(r)[Ve])?t:v(n)},We=d.process,Ue=d.setImmediate,Ge=d.clearImmediate,qe=d.MessageChannel,Ye=d.Dispatch,Xe=0,Ke={},Je=function(){var e=+this;if(Ke.hasOwnProperty(e)){var t=Ke[e];delete Ke[e],t()}},Qe=function(e){Je.call(e.data)};Ue&&Ge||(Ue=function(e){for(var t=[],n=1;arguments.length>n;)t.push(arguments[n++]);return Ke[++Xe]=function(){!function(e,t,n){var r=void 0===n;switch(t.length){case 0:return r?e():e.call(n);case 1:return r?e(t[0]):e.call(n,t[0]);case 2:return r?e(t[0],t[1]):e.call(n,t[0],t[1]);case 3:return r?e(t[0],t[1],t[2]):e.call(n,t[0],t[1],t[2]);case 4:return r?e(t[0],t[1],t[2],t[3]):e.call(n,t[0],t[1],t[2],t[3])}e.apply(n,t)}("function"==typeof e?e:Function(e),t)},Le(Xe),Xe},Ge=function(e){delete Ke[e]},"process"==A(We)?Le=function(e){We.nextTick(p(Je,e,1))}:Ye&&Ye.now?Le=function(e){Ye.now(p(Je,e,1))}:qe?(Oe=(Te=new qe).port2,Te.port1.onmessage=Qe,Le=p(Oe.postMessage,Oe,1)):d.addEventListener&&"function"==typeof postMessage&&!d.importScripts?(Le=function(e){d.postMessage(e+"","*")},d.addEventListener("message",Qe,!1)):Le="onreadystatechange"in b("script")?function(e){te.appendChild(b("script")).onreadystatechange=function(){te.removeChild(this),Je.call(e)}}:function(e){setTimeout(p(Je,e,1),0)});var Ze={set:Ue,clear:Ge},$e=Ze.set,et=d.MutationObserver||d.WebKitMutationObserver,tt=d.process,nt=d.Promise,rt="process"==A(tt);function it(e){var t,n;this.promise=new e(function(e,r){if(void 0!==t||void 0!==n)throw TypeError("Bad Promise constructor");t=e,n=r}),this.resolve=v(t),this.reject=v(n)}var ot={f:function(e){return new it(e)}},st=function(e){try{return{e:!1,v:e()}}catch(e){return{e:!0,v:e}}},lt=d.navigator,at=lt&&lt.userAgent||"",ut=function(e,t){if(_(e),m(t)&&t.constructor===e)return t;var n=ot.f(e);return(0,n.resolve)(t),n.promise},ct=se("species"),ht=se("iterator"),dt=!1;try{[7][ht]().return=function(){dt=!0}}catch(e){}var ft,vt,pt,mt,_t,gt,yt=Ze.set,xt=function(){var e,t,n,r=function(){var r,i;for(rt&&(r=tt.domain)&&r.exit();e;){i=e.fn,e=e.next;try{i()}catch(r){throw e?n():t=void 0,r}}t=void 0,r&&r.enter()};if(rt)n=function(){tt.nextTick(r)};else if(!et||d.navigator&&d.navigator.standalone)if(nt&&nt.resolve){var i=nt.resolve(void 0);n=function(){i.then(r)}}else n=function(){$e.call(d,r)};else{var o=!0,s=document.createTextNode("");new et(r).observe(s,{characterData:!0}),n=function(){s.data=o=!o}}return function(r){var i={fn:r,next:void 0};t&&(t.next=i),e||(e=i,n()),t=i}}(),Et=d.TypeError,bt=d.process,Ct=bt&&bt.versions,kt=Ct&&Ct.v8||"",Nt=d.Promise,wt="process"==Fe(bt),St=function(){},It=vt=ot.f,Lt=!!function(){try{var e=Nt.resolve(1),t=(e.constructor={})[se("species")]=function(e){e(St,St)};return(wt||"function"==typeof PromiseRejectionEvent)&&e.then(St)instanceof t&&0!==kt.indexOf("6.6")&&-1===at.indexOf("Chrome/66")}catch(e){}}(),Tt=function(e){var t;return!(!m(e)||"function"!=typeof(t=e.then))&&t},Ot=function(e,t){if(!e._n){e._n=!0;var n=e._c;xt(function(){for(var r=e._v,i=1==e._s,o=0,s=function(t){var n,o,s,l=i?t.ok:t.fail,a=t.resolve,u=t.reject,c=t.domain;try{l?(i||(2==e._h&&Ft(e),e._h=1),!0===l?n=r:(c&&c.enter(),n=l(r),c&&(c.exit(),s=!0)),n===t.promise?u(Et("Promise-chain cycle")):(o=Tt(n))?o.call(n,a,u):a(n)):u(r)}catch(e){c&&!s&&c.exit(),u(e)}};n.length>o;)s(n[o++]);e._c=[],e._n=!1,t&&!e._h&&Pt(e)})}},Pt=function(e){yt.call(d,function(){var t,n,r,i=e._v,o=Mt(e);if(o&&(t=st(function(){wt?bt.emit("unhandledRejection",i,e):(n=d.onunhandledrejection)?n({promise:e,reason:i}):(r=d.console)&&r.error&&r.error("Unhandled promise rejection",i)}),e._h=wt||Mt(e)?2:1),e._a=void 0,o&&t.e)throw t.v})},Mt=function(e){return 1!==e._h&&0===(e._a||e._c).length},Ft=function(e){yt.call(d,function(){var t;wt?bt.emit("rejectionHandled",e):(t=d.onrejectionhandled)&&t({promise:e,reason:e._v})})},Rt=function(e){var t=this;t._d||(t._d=!0,(t=t._w||t)._v=e,t._s=2,t._a||(t._a=t._c.slice()),Ot(t,!0))},At=function(e){var t,n=this;if(!n._d){n._d=!0,n=n._w||n;try{if(n===e)throw Et("Promise can't be resolved itself");(t=Tt(e))?xt(function(){var r={_w:n,_d:!1};try{t.call(e,p(At,r,1),p(Rt,r,1))}catch(e){Rt.call(r,e)}}):(n._v=e,n._s=1,Ot(n,!1))}catch(e){Rt.call({_w:n,_d:!1},e)}}};Lt||(Nt=function(e){!function(e,t,n,r){if(!(e instanceof t)||void 0!==r&&r in e)throw TypeError(n+": incorrect invocation!")}(this,Nt,"Promise","_h"),v(e),ft.call(this);try{e(p(At,this,1),p(Rt,this,1))}catch(e){Rt.call(this,e)}},(ft=function(e){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=function(e,t,n){for(var r in t)n&&e[r]?e[r]=t[r]:S(e,r,t[r]);return e}(Nt.prototype,{then:function(e,t){var n=It(De(this,Nt));return n.ok="function"!=typeof e||e,n.fail="function"==typeof t&&t,n.domain=wt?bt.domain:void 0,this._c.push(n),this._a&&this._a.push(n),this._s&&Ot(this,!1),n.promise},catch:function(e){return this.then(void 0,e)}}),pt=function(){var e=new ft;this.promise=e,this.resolve=p(At,e,1),this.reject=p(Rt,e,1)},ot.f=It=function(e){return e===Nt||e===mt?new pt(e):vt(e)}),P(P.G+P.W+P.F*!Lt,{Promise:Nt}),ue(Nt,"Promise"),gt="function"==typeof f[_t="Promise"]?f[_t]:d[_t],y&&gt&&!gt[ct]&&N.f(gt,ct,{configurable:!0,get:function(){return this}}),mt=f.Promise,P(P.S+P.F*!Lt,"Promise",{reject:function(e){var t=It(this);return(0,t.reject)(e),t.promise}}),P(P.S+!0*P.F,"Promise",{resolve:function(e){return ut(this===mt?Nt:this,e)}}),P(P.S+P.F*!(Lt&&function(e,t){if(!t&&!dt)return!1;var n=!1;try{var r=[7],i=r[ht]();i.next=function(){return{done:n=!0}},r[ht]=function(){return i},e(r)}catch(e){}return n}(function(e){Nt.all(e).catch(St)})),"Promise",{all:function(e){var t=this,n=It(t),r=n.resolve,i=n.reject,o=st(function(){var n=[],o=0,s=1;ze(e,!1,function(e){var l=o++,a=!1;n.push(void 0),s++,t.resolve(e).then(function(e){a||(a=!0,n[l]=e,--s||r(n))},i)}),--s||r(n)});return o.e&&i(o.v),n.promise},race:function(e){var t=this,n=It(t),r=n.reject,i=st(function(){ze(e,!1,function(e){t.resolve(e).then(n.resolve,r)})});return i.e&&r(i.v),n.promise}}),P(P.P+P.R,"Promise",{finally:function(e){var t=De(this,f.Promise||d.Promise),n="function"==typeof e;return this.then(n?function(n){return ut(t,e()).then(function(){return n})}:e,n?function(n){return ut(t,e()).then(function(){throw n})}:e)}}),P(P.S,"Promise",{try:function(e){var t=ot.f(this),n=st(e);return(n.e?t.reject:t.resolve)(n.v),t.promise}});var Ht=f.Promise,jt=t(function(e){e.exports={default:Ht,__esModule:!0}});e(jt);var Bt=e(t(function(e,t){t.__esModule=!0;var n,r=(n=jt)&&n.__esModule?n:{default:n};t.default=function(e){return function(){var t=e.apply(this,arguments);return new r.default(function(e,n){return function i(o,s){try{var l=t[o](s),a=l.value}catch(e){return void n(e)}if(!l.done)return r.default.resolve(a).then(function(e){i("next",e)},function(e){i("throw",e)});e(a)}("next")})}}})),zt={f:Object.getOwnPropertySymbols},Vt={f:{}.propertyIsEnumerable},Dt=Object.assign,Wt=!Dt||g(function(){var e={},t={},n=Symbol(),r="abcdefghijklmnopqrst";return e[n]=7,r.split("").forEach(function(e){t[e]=e}),7!=Dt({},e)[n]||Object.keys(Dt({},t)).join("")!=r})?function(e,t){for(var n=fe(e),r=arguments.length,i=1,o=zt.f,s=Vt.f;r>i;)for(var l,a=H(arguments[i++]),u=o?Z(a).concat(o(a)):Z(a),c=u.length,h=0;c>h;)s.call(a,l=u[h++])&&(n[l]=a[l]);return n}:Dt;P(P.S+P.F,"Object",{assign:Wt});var Ut=f.Object.assign,Gt=t(function(e){e.exports={default:Ut,__esModule:!0}});e(Gt);var qt=e(t(function(e,t){t.__esModule=!0;var n,r=(n=Gt)&&n.__esModule?n:{default:n};t.default=r.default||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}})),Yt=e(t(function(e,t){t.__esModule=!0,t.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}}));P(P.S+P.F*!y,"Object",{defineProperty:N.f});var Xt=f.Object,Kt=function(e,t,n){return Xt.defineProperty(e,t,n)},Jt=t(function(e){e.exports={default:Kt,__esModule:!0}});e(Jt);var Qt=e(t(function(e,t){t.__esModule=!0;var n,r=(n=Jt)&&n.__esModule?n:{default:n};t.default=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),(0,r.default)(e,i.key,i)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}()}));return function(){function e(t){Yt(this,e),this.context=this,this.parentNode=void 0,this.getData=void 0,this.getElementChildren=void 0,this.getCellRenderer=void 0,this.virtualEnvironment=!1,this.needUpdateVirtualDOM=void 0,this.renderOnInitialize=!0,this.initialScrollToElement=void 0,this.observeCellBounds=!1,this.rememberChildrenExpands=!0,this.thresholdRatio=.5,this.preventWheelBubbling=!1,this.useTransform=!0,this.className="mnstr",this.didRenderFirstElement=void 0,this.didRenderLastElement=void 0,this.firstInBoundsElementChanged=void 0,this.lastInBoundsElementChanged=void 0,this._data=[],this._scrollNode=void 0,this._listNode=void 0,this._events={},this._lastScrollPosition=0,this._lowestCellHeigh=Number.MAX_VALUE,this._averageCellHeight=1,this._currentMaxIndex=0,this._initialScrollToElement=void 0,this._cachedScrollToElement=void 0,this._firstInBoundsElement=void 0,this._lastInBoundsElement=void 0,this._frameRequests={},this._cellsSorted=[],this._vElements=[],this._expandInformations=[],this._didScrollToBounds=!1,this._updatingCells=!1,t=t||{},Object.keys(t).forEach(function(e){"_"===e.charAt(0)&&delete t[e]}),qt(this,t),this._initialScrollToElement=this.initialScrollToElement,this._cachedScrollToElement=this._initialScrollToElement,this.renderOnInitialize&&this.render()}return Qt(e,[{key:"destroy",value:function(){console.error("wheeee.")}},{key:"reset",value:function(){var e=Bt(l.mark(function e(){return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this._data=[],this._lastScrollPosition=0,this._lowestCellHeight=Number.MAX_VALUE,this._averageCellHeight=1,this._currentMaxIndex=0,this._cachedScrollToElement=void 0,this._frameRequests={},this._cellsSorted=[],this._expandInformations=[],this._vElements=[],!this.virtualEnvironment){e.next=15;break}return e.next=13,this.updateVirtualDOM();case 13:e.next=16;break;case 15:for(;this._listNode.firstChild;)this._listNode.removeChild(this._listNode.firstChild);case 16:this.needUpdate(),this.setScrollPosition(0),this.rUpdateCells();case 19:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(e){var t=this;return this.needUpdate(),this.renderScrollNode(e),this.renderListNode(),this.initScrollListener(),this.rAF(Bt(l.mark(function e(){return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.updateCells(!0);case 2:t.renderListResizeObserver();case 3:case"end":return e.stop()}},e,t)})),"render"),this}},{key:"renderScrollNode",value:function(e){return this._scrollNode&&this._scrollNode.parentNode&&this._scrollNode.parentNode.removeChild(this._scrollNode),this._scrollNode=document.createElement("div"),this._scrollNode.classList.add(this.className),this._scrollNode.setAttribute("style","overflow-y: auto; -webkit-overflow-scrolling: touch; overflow-scrolling: touch; position: relative;"),this.parentNode=e||this.parentNode||document.body,this.parentNode.appendChild(this._scrollNode),this._scrollNode}},{key:"renderListNode",value:function(){return this._listNode=document.createElement("ul"),this._listNode.classList.add(this.className+"-list"),this._listNode.setAttribute("style","position: relative; overflow: hidden; list-style-type: none; margin: 0; padding: 0;"),this._scrollNode.appendChild(this._listNode),this._listNode}},{key:"renderIFrame",value:function(e,t){var n=this,r=document.createElement("iframe");return r.setAttribute("style","position: absolute; left: 0; top: 0; width: 100%; height: 100%; margin: 0; border: none; opacity: 0; pointer-events: none; touch-action: none; z-index: -1000;"),r.onload=function(e){e.target.contentWindow.onresize=t.bind(n)},e.appendChild(r),r}},{key:"renderListResizeObserver",value:function(){this._scrollNode.__frameNode=this.renderIFrame(this._scrollNode,this.onResizeScrollNode)}},{key:"renderCell",value:function(){var e=document.createElement("li");e.classList.add(this.className+"-cell"),e.setAttribute("style","position: absolute; width: 100%; top: 0; left: 0;"),e.__frameNode=this.observeCellBounds?this.renderIFrame(e,this.onResizeCell):void 0;var t=document.createElement("div");return t.classList.add(this.className+"-content"),t.setAttribute("style","width: 100%; margin: 0; border: 0;"),e.appendChild(t),e.__contentNode=t,this._listNode.appendChild(e),e}},{key:"updateVirtualDOM",value:function(){var e=this;return new Promise(function(t){e.needUpdateVirtualDOM.call(e.context,e._vElements,function(){return t()})})}},{key:"addVirtualElement",value:function(e,t,n,r){this._vElements&&this._vElements.push(this.createVirtualElement(e,t,n,r))}},{key:"removeVirtualElementForCell",value:function(e){this._vElements&&this._vElements.splice([].slice.call(this.getCells()).indexOf(e),1)}},{key:"sortVirtualElements",value:function(){this._vElements&&this._vElements.sort(function(e,t){return e.index<t.index?-1:1})}},{key:"replaceVirtualElementForCell",value:function(e,t,n,r,i){this._vElements&&this._vElements.splice([].slice.call(this.getCells()).indexOf(t),1,this.createVirtualElement(e,n,r,i))}},{key:"createVirtualElement",value:function(e,t,n,r){return{element:e,index:t,isExpanded:n,level:r}}},{key:"syncCellSortingWithDOM",value:function(e,t){for(var n=this.getCells(),r=0;r<n.length;r++){var i=n[r];void 0!==e&&this.setNodeTop(i,e),i.__index=t,e=e||0,e+=this.getNodeHeight(i),t++}}},{key:"getNodeHeight",value:function(e,t){return t||!e.__nodeHeight?this.setNodeHeight(e,t):e.__nodeHeight||0}},{key:"setNodeHeight",value:function(e,t,n,r){return n=Math.max(n,0),r&&(e.style.height=n+"px"),e.__nodeHeight=n||t?e.getBoundingClientRect().height:e.offsetHeight,e.__nodeHeight}},{key:"getNodeTop",value:function(e){return e.__nodeTop||0}},{key:"setNodeTop",value:function(e,t){return t=Math.max(t,0),this.useTransform?e.style.transform="translateY("+t+"px)":e.style.top=t+"px",e.__nodeTop=t,e.__nodeTop}},{key:"getNodeBottom",value:function(e){return this.getNodeTop(e)+this.getNodeHeight(e)}},{key:"getFirstCellTop",value:function(){return this._cellsSorted&&this._cellsSorted.length>0?this.getNodeTop(this._cellsSorted[0]):0}},{key:"getLastCellBottom",value:function(){return this._cellsSorted&&this._cellsSorted.length>0?this.getNodeBottom(this._cellsSorted[this._cellsSorted.length-1]):0}},{key:"getMinimumListNodeHeight",value:function(){var e=this.getNodeHeight(this._scrollNode,!0);return e+e*(2*this.thresholdRatio)}},{key:"updateListBounds",value:function(){var e=this.getLastCellBottom(),t=this.getNodeHeight(this._listNode);if(this.getLastRenderIndex()===this._currentMaxIndex)e-t!=0&&this.setNodeHeight(this._listNode,!1,e,!0);else{var n=this._averageCellHeight*(this._currentMaxIndex+1),r=Math.max(e,n);r!==t&&this.setNodeHeight(this._listNode,!1,r,!0)}}},{key:"getTopRenderThreshold",value:function(){return-this.getNodeHeight(this._scrollNode)*this.thresholdRatio}},{key:"getBottomRenderThreshold",value:function(){var e=this.getNodeHeight(this._scrollNode);return e*this.thresholdRatio+e}},{key:"getCells",value:function(){return this._listNode.children}},{key:"getCellsSorted",value:function(){return this._cellsSorted?this._cellsSorted:this.updateCellsSorted()}},{key:"updateCellsSorted",value:function(){var e=this.getCells();return this._cellsSorted=[].slice.call(e),this._cellsSorted.sort(function(e,t){return e.__index-t.__index}),this._cellsSorted}},{key:"getFirstRenderIndex",value:function(){return this._cellsSorted&&this._cellsSorted.length>0?this._cellsSorted[0].__index:-1}},{key:"getLastRenderIndex",value:function(){return this._cellsSorted&&this._cellsSorted.length>0?this._cellsSorted[this._cellsSorted.length-1].__index:-1}},{key:"addEventListener",value:function(e,t){return this._events[e]=this._events[e]||[],this._events[e].push(t),this}},{key:"removeEventListener",value:function(e,t){if(this._events[e]){var n=this._events[e].indexOf(t);n>-1&&this._events[e].splice(n,1)}}},{key:"emitEvent",value:function(e){var t=this,n=this._events[e],r=[].slice.call(arguments,1);n&&n.length>0&&n.forEach(function(e){return e.apply(t,r)}),this[e]&&this[e].apply(this.context,r)}},{key:"emitElementEvents",value:function(e,t){0===t&&this.emitEvent("didRenderFirstElement",e,this),t===this._currentMaxIndex&&this.emitEvent("didRenderLastElement",e,this)}},{key:"getScrollPosition",value:function(){return this._scrollNode.scrollTop}},{key:"setScrollPosition",value:function(e){this._scrollNode.scrollTop=e}},{key:"initScrollListener",value:function(){var e=this;this._scrollNode.addEventListener("scroll",function(t){return e.rAF(e.onScroll,"onscroll",t)}),this.preventWheelBubbling&&this._scrollNode.addEventListener("wheel",this.onWheel)}},{key:"onWheel",value:function(e){var t=e.deltaY,n=t<0&&0===this._scrollNode.scrollTop,r=t>0&&this._scrollNode.scrollTop>=this.getNodeHeight(this._listNode)-this.getNodeHeight(this._scrollNode);this._didScrollToBounds=n||r,this._didScrollToBounds&&e.preventDefault(),n&&(this.setScrollPosition(1),this.setScrollPosition(0))}},{key:"onScroll",value:function(e){this._lastScrollPosition=this._scrollNode.scrollTop,this._didScrollToBounds=this._scrollNode.scrollTop<=this._lastScrollPosition||this._scrollNode.scrollTop>=this._lastScrollPosition,this.rUpdateCells()}},{key:"scrollToFirstElement",value:function(){var e=this.getElementAndLevelAtIndex(0);this.scrollToElement(e.element)}},{key:"scrollToLastElement",value:function(){var e=this.getElementAndLevelAtIndex(this._currentMaxIndex);this.scrollToElement(e.element)}},{key:"scrollToElement",value:function(e){var t=this;this.rAF(Bt(l.mark(function n(){var r,i;return l.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(r=t.findCellByElement(e)){n.next=4;break}return n.next=4,t.updateCells();case 4:if(!r){n.next=9;break}return t.setScrollPosition(t.getNodeTop(r)),delete t._cachedScrollToElement,delete t._initialScrollToElement,n.abrupt("return");case 9:if(!((i=t.getIndexForElement(e))<0)){n.next=12;break}return n.abrupt("return");case 12:if(t._cachedScrollToElement=e,0!==t._cellsSorted.length){n.next=15;break}return n.abrupt("return");case 15:t.setScrollPosition(i*t._averageCellHeight);case 16:case"end":return n.stop()}},n,t)})))}},{key:"scrollToCachedScrollElement",value:function(){this._cachedScrollToElement&&this.scrollToElement(this._cachedScrollToElement)}},{key:"needUpdate",value:function(){return this._data=this.getData?this.getData.call(this.context,this):[],this.updateCurrentMaxIndex(),this.invalidateExpandInformations(),this}},{key:"update",value:function(e,t){return this.needUpdate(),this.rUpdateCells(!0,e,t),this}},{key:"getElementAndLevelAtIndex",value:function(e){if(!this.canHasChildren())return this.createElementAndLevelInformation(this._data[e],0);for(var t=0,n=this._expandInformations.length-1;n>=0;n--){var r=this._expandInformations[n];if(r.active&&!(r.index>=e)&&(t+=r.elementChildren.length,!(r.index+t<e))){var i=e-(r.index+t-r.elementChildren.length)-1;return this.createElementAndLevelInformation(r.elementChildren[i],r.level)}}return this.createElementAndLevelInformation(this._data[e-t],0)}},{key:"createElementAndLevelInformation",value:function(e,t){return{element:e,level:t}}},{key:"updateCurrentMaxIndex",value:function(){for(var e=0,t=0;t<this._expandInformations.length;t++){var n=this._expandInformations[t];e+=n.active?n.elementChildren.length:0}this._currentMaxIndex=this._data.length-1+e}},{key:"canHasChildren",value:function(){return void 0!==this.getElementChildren}},{key:"getElementChildren",value:function(e){return this.canHasChildren()?this.getElementChildren.call(this.context,e,this):void 0}},{key:"getIndexForElement",value:function(e){for(var t=this._data.indexOf(e),n=t>-1?this._data:void 0,r=void 0,i=0,o=0,s=0;s<this._expandInformations.length;s++){var l=this._expandInformations[s];if(n===this._data&&!l.elementParent&&l.index>=t)break;if(!n){var a=l.elementChildren.indexOf(e);if(a>-1){t=a,n=l.elementChildren,r=l,i=l.index+1,o=0;continue}}if(r&&l.level>r.level){var u=i+t;if(u<=l.index)return u;o+=l.elementChildren.length}else{if(r)return i+t+o;o+=l.elementChildren.length}}return t>-1?t+o+i:t}},{key:"addCellsIfNeeded",value:function(){var e=Bt(l.mark(function e(){var t,n,r,i,o,s,a,u,c,h,d;return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!1;case 1:if(!(0===this.getCellsSorted().length||this._lowestCellHeight*(this.getCells().length-2)<this.getMinimumListNodeHeight())){e.next=25;break}if(n=this.getFirstRenderIndex(),r=this.getLastRenderIndex(),i=r<this._currentMaxIndex,!(r>=this._currentMaxIndex&&n<=0)){e.next=7;break}return e.abrupt("break",25);case 7:if(o=i?++r:--n,!((o=this._initialScrollToElement&&0===this.getCellsSorted().length?this.getIndexForElement(this._initialScrollToElement):o)<0||o>this._currentMaxIndex||isNaN(o))){e.next=11;break}return e.abrupt("break",25);case 11:return s=this.virtualEnvironment?void 0:this.renderCell(),e.next=14,this.updateCell(s,o);case 14:(s=e.sent).__frameNode=this.virtualEnvironment&&this.observeCellBounds?this.renderIFrame(s,this.onResizeCell):s.__frameNode,this.setNodeHeight(s),a=i?this.getLastCellBottom():this.getFirstCellTop()-this.getNodeHeight(s),this.setNodeTop(s,a),this.updateCellsAverages(),this.updateCellsSorted(),this.updateListBounds(),t=!0,e.next=1;break;case 25:if(this._initialScrollToElement){for(u=this.getFirstRenderIndex()*this._averageCellHeight,c=this.getCellsSorted(),h=0;h<c.length;h++)d=c[h],this.setNodeTop(d,u),u+=this.getNodeHeight(d);this.updateListBounds()}return e.abrupt("return",t);case 27:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"removeCellsIfNeeded",value:function(){var e=Bt(l.mark(function e(){var t,n,r,i,o,s,a;return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:for(t=this.getCellsSorted(),n=this.getMinimumListNodeHeight(),r=!1,i=t.length-1;i>=0;i--)((o=t[i]).__index<0||o.__index>this._currentMaxIndex||i===t.length-1&&this._lowestCellHeight*(t.length-2)-this.getNodeHeight(o)>n)&&(this.virtualEnvironment?this.removeVirtualElementForCell(o):this._listNode.removeChild(o),t.splice(i,1),r=!0);if(!this.virtualEnvironment||!this._vElements||this._vElements.length===this.getCells().length){e.next=16;break}if(!(t.length>0)){e.next=14;break}return s=this.getNodeTop(t[0]),a=t[0].__index,this.sortVirtualElements(),e.next=11,this.updateVirtualDOM();case 11:this.syncCellSortingWithDOM(s,a),e.next=16;break;case 14:return e.next=16,this.updateVirtualDOM();case 16:return this.updateCellsSorted(),this.updateCellsAverages(),this.updateListBounds(),e.abrupt("return",r);case 20:case"end":return e.stop()}},e,this)}));return function(){return e.apply(this,arguments)}}()},{key:"rUpdateCells",value:function(e,t,n,r){this.rAF(this.updateCells,"updatecells",e,t,n,r)}},{key:"updateCells",value:function(){var e=Bt(l.mark(function e(t,n,r,i){var o,s,a,u,c,h,d,f,v,p,m,_,g,y,x,E,b,C,k,N;return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._updatingCells){e.next=2;break}return e.abrupt("return");case 2:if(o=this.getScrollPosition(),s=this.getTopRenderThreshold(),a=this.getBottomRenderThreshold(),u=this.getFirstCellTop(),c=this.getLastCellBottom(),h=this.getFirstRenderIndex(),d=this.getLastRenderIndex(),v=u>o+a,p=c<o+s,m=c<o+a,_=0,g=1,y=0,x=!1,E=!1,b=!1,(f=u>o+s)||m||t){e.next=24;break}return this.updateFirstAndLastCellInViewport(),e.abrupt("return");case 24:if(!v&&!p){e.next=31;break}C=Math.round(Math.max(o+s,0)/this._averageCellHeight),_=Math.min(C,this._currentMaxIndex-this.getCellsSorted().length+g),y=_*this._averageCellHeight,E=!0,e.next=52;break;case 31:if(!(m&&d<this._currentMaxIndex)||i){e.next=37;break}_=d+g,y=c,x=!0,e.next=52;break;case 37:if(!f||!(h>0||t)||i){e.next=44;break}_=h+(g=-1),y=u,x=!0,e.next=52;break;case 44:if(!t){e.next=50;break}_=h,y=u,E=!0,e.next=52;break;case 50:return this.updateFirstAndLastCellInViewport(),e.abrupt("return");case 52:return this._updatingCells=!0,k=0,t&&(r?(N=this.findCellIndexDeviation(),k=Math.round(N*this._averageCellHeight),_+=N,m&&d+N>=this._currentMaxIndex&&(_=h+N,y=u)):(_=0,y=0,x=!1,E=!0,t=!1,this.setScrollPosition(0))),e.next=57,this.updateCellsCore(_,g,y,n,x,t,E,o,s,a);case 57:if(b=e.sent,!t||!r){e.next=67;break}return _=g>0?this.getFirstRenderIndex():this.getLastRenderIndex(),y=g>0?this.getFirstCellTop()+k:this.getLastCellBottom()+k,e.next=63,this.updateCellsCore(_,g,y,n,!1,!1,!0,o,s,a);case 63:if(e.t0=e.sent,e.t0){e.next=66;break}e.t0=b;case 66:b=e.t0;case 67:this.updateListBounds(),k&&this.setScrollPosition(this.getScrollPosition()+k),b&&this.emitEvent("cellsUpdated",this._cellsSorted,this),this._updatingCells=!1,this.scrollToCachedScrollElement(),this.updateFirstAndLastCellInViewport();case 73:case"end":return e.stop()}},e,this)}));return function(t,n,r,i){return e.apply(this,arguments)}}()},{key:"updateCellsCore",value:function(){var e=Bt(l.mark(function e(t,n,r,i,o,s,a,u,c,h){var d,f,v,p,m,_;return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:d=this.getCellsSorted(),f=!1,v=!1,p=!1,m=0;case 5:if(!(m<d.length)){e.next=35;break}if(_=d[n>0?m:d.length-1-m],!s){e.next=12;break}_.__index=t,r+=this.getNodeHeight(_)*n,e.next=24;break;case 12:return e.next=14,this.updateCell(_,t,i);case 14:if(e.t1=e.sent,e.t2=void 0,e.t0=e.t1!==e.t2,e.t0){e.next=19;break}e.t0=a;case 19:if(!e.t0){e.next=24;break}this.setNodeHeight(_),n>0?(this.setNodeTop(_,r),r+=t>-1?this.getNodeHeight(_):0):(r-=this.getNodeHeight(_),this.setNodeTop(_,r)),f=f||this.getNodeHeight(_)>0&&this.getNodeHeight(_)<this._lowestCellHeight,p=!0;case 24:if(t+=n,v||!(n>0&&r>u+h||n<0&&r<u+c)){e.next=30;break}if(v=!0,t-=s&&o?d.length*n:0,s||a){e.next=30;break}return e.abrupt("break",35);case 30:if(s||!(t>this._currentMaxIndex||t<0)){e.next=32;break}return e.abrupt("break",35);case 32:m++,e.next=5;break;case 35:if(this.updateCellsSorted(),s||!(t<=0&&-1===n&&0!==r||r<0)){e.next=45;break}return e.next=39,this.updateCellsCore(0,1,0,!1,!1,!1,!0,0,c,h);case 39:if(e.t3=e.sent,e.t3){e.next=42;break}e.t3=p;case 42:return p=e.t3,this.setScrollPosition(0),e.abrupt("return",p);case 45:if(!f&&!a){e.next=59;break}return this.updateCellsAverages(),e.next=49,this.addCellsIfNeeded();case 49:if(e.t4=e.sent,e.t4){e.next=52;break}e.t4=p;case 52:return p=e.t4,e.next=55,this.removeCellsIfNeeded();case 55:if(e.t5=e.sent,e.t5){e.next=58;break}e.t5=p;case 58:p=e.t5;case 59:return e.abrupt("return",p);case 60:case"end":return e.stop()}},e,this)}));return function(t,n,r,i,o,s,l,a,u,c){return e.apply(this,arguments)}}()},{key:"updateCell",value:function(){var e=Bt(l.mark(function e(t,n,r){var i,o,s,a,u,c;return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=this.getElementAndLevelAtIndex(n)){e.next=3;break}return e.abrupt("return");case 3:if(o=i.element,s=i.level,o&&(!t||o!==t.__element||r)){e.next=7;break}return e.abrupt("return");case 7:if(a=this.canHasChildren()?this.getExpandInformationForElement(o):void 0,t&&this.disableNodeResizeObserving(t),this.virtualEnvironment){e.next=14;break}"string"==typeof(u=this.getCellRenderer?this.getCellRenderer.call(this.context,o,n,void 0!==a,this):"")||u instanceof String?t.__contentNode.innerHTML=u:(t.__contentNode.innerHTML="",t.__contentNode.appendChild(u)),e.next=18;break;case 14:return t?this.replaceVirtualElementForCell(o,t,n,void 0!==a,s):this.addVirtualElement(o,n,void 0!==a,s),e.next=17,this.updateVirtualDOM();case 17:t||(c=this.getCells(),t=c[c.length-1]);case 18:return this.observeCellBounds&&this.rAF(this.enableNodeResizeObserving,!1,t),a?t.classList.add("expanded"):t.classList.remove("expanded"),t.dataset.level=s,t.__element=o,t.__index=n,t.__level=s,this.emitElementEvents(o,n),e.abrupt("return",t);case 26:case"end":return e.stop()}},e,this)}));return function(t,n,r){return e.apply(this,arguments)}}()},{key:"findCellIndexDeviation",value:function(){for(var e=0;e<this._cellsSorted.length;e++){var t=this._cellsSorted[e],n=this.getIndexForElement(t.__element);if(-1!==n)return n===t.__index?0:n-t.__index}return 0}},{key:"updateCellsAverages",value:function(){var e=this.getCells(),t=0;this._lowestCellHeight=Number.MAX_VALUE;for(var n=0;n<e.length;n++){var r=this.getNodeHeight(e[n]);t+=r,this._lowestCellHeight=0===this._lowestCellHeight?r:Math.min(this._lowestCellHeight,r)}this._averageCellHeight=t/e.length}},{key:"findCellByElement",value:function(e){for(var t=0;t<this._cellsSorted.length;t++){var n=this._cellsSorted[t];if(n.__element===e)return n}}},{key:"cellBoundsUpdated",value:function(){this.rUpdateCells(!0,!1,!0,!0)}},{key:"updateFirstAndLastCellInViewport",value:function(){for(var e=this.getScrollPosition(),t=this.getNodeHeight(this._scrollNode),n=this.getCellsSorted(),r=e+t,i=Math.max(1,Math.round(n.length/5)),o=-1,s=-1,l=0;l<n.length;l+=i){var a=n[l];if(this.getNodeTop(a)>e){o=Math.max(0,l-i);break}}if(o>-1){for(;;){var u=n[o];if(this.getNodeTop(u)>=e)break;o++}for(s=o;;){var c=n[s];if(!c||this.getNodeTop(c)+this.getNodeHeight(c)>=r){s--;break}s++}if(o<0||s<0)return;var h=n[o].__element,d=n[s].__element;h!==this._firstInBoundsElement&&(this._firstInBoundsElement=h,this.emitEvent("firstInBoundsElementChanged",this._firstInBoundsElement,this)),d!==this._lastInBoundsElement&&(this._lastInBoundsElement=d,this.emitEvent("lastInBoundsElementChanged",this._lastInBoundsElement,this))}}},{key:"onResizeScrollNode",value:function(e){var t=this;this.disableAllCellsResizeObserving(),this.rAF(Bt(l.mark(function e(){return l.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.updateCells(!0,!1,!0,!0);case 2:t.setNodeHeight(t._scrollNode),t.enableAllCellsResizeObserving();case 4:case"end":return e.stop()}},e,t)})),"resizelist")}},{key:"onResizeCell",value:function(e){this.cellBoundsUpdated()}},{key:"disableNodeResizeObserving",value:function(e){e.__frameNode&&e.__frameNode.contentWindow&&e.__frameNode.contentWindow.onresize&&(e.__frameNode.contentWindow.__onresize=e.__frameNode.contentWindow.onresize,e.__frameNode.contentWindow.onresize=void 0)}},{key:"enableNodeResizeObserving",value:function(e){this.observeCellBounds&&e.__frameNode&&e.__frameNode.contentWindow&&e.__frameNode.contentWindow.__onresize&&(e.__frameNode.contentWindow.onresize=e.__frameNode.contentWindow.__onresize,e.__frameNode.contentWindow.__onresize=void 0)}},{key:"disableAllCellsResizeObserving",value:function(){if(this.observeCellBounds)for(var e=0;e<this._cellsSorted.length;e++)this.disableNodeResizeObserving(this._cellsSorted[e])}},{key:"enableAllCellsResizeObserving",value:function(){if(this.observeCellBounds)for(var e=0;e<this._cellsSorted.length;e++)this.enableNodeResizeObserving(this._cellsSorted[e])}},{key:"isElementExpanded",value:function(e){return void 0!==this.getExpandInformationForElement(e)}},{key:"expandElement",value:function(e){this.addExpandInformationForElement(e),this.updateCells(!0,!1,!0)}},{key:"collapseElement",value:function(e){this.removeExpandInformationForElement(e),this.updateCells(!0,!1,!0)}},{key:"toggleExpandElement",value:function(e){this.isElementExpanded(e)?this.collapseElement(e):this.expandElement(e)}},{key:"getExpandInformationForElement",value:function(e){for(var t=0;t<this._expandInformations.length;t++){var n=this._expandInformations[t];if(n.element===e)return n}}},{key:"getExpandInformationForElementParent",value:function(e){for(var t=0;t<this._expandInformations.length;t++){var n=this._expandInformations[t];if(n.elementChildren.indexOf(e)>-1)return n}}},{key:"createExpandInformation",value:function(e){var t=this.getExpandInformationForElementParent(e);return{active:!0,element:e,elementIndex:t?t.elementChildren.indexOf(e):this._data.indexOf(e),elementChildren:this.getElementChildren(e),elementParent:t?t.element:void 0,index:void 0,level:t?t.level+1:1,totalLength:0}}},{key:"addExpandInformationForElement",value:function(e){var t=this.createExpandInformation(e);if(this._expandInformations.push(t),this.sortExpandInformations(),this.rememberChildrenExpands)for(var n=this._expandInformations.indexOf(t)+1;n<this._expandInformations.length;n++){var r=this._expandInformations[n];if(r.level<=t.level)break;r.active=!0}this.calculateExpandInformationIndexes()}},{key:"removeExpandInformationForElement",value:function(e){for(var t=this.getExpandInformationForElement(e),n=[t],r=this._expandInformations.indexOf(t)+1;r<this._expandInformations.length;r++){var i=this._expandInformations[r];if(i.level<=t.level)break;n.push(i)}for(var o=0;o<n.length;o++){var s=n[o];s===t?this.removeElementFromArray(this._expandInformations,s):this.rememberChildrenExpands?s.active=!1:this.removeElementFromArray(this._expandInformations,s)}this.calculateExpandInformationIndexes()}},{key:"invalidateExpandInformations",value:function(){this.sortExpandInformations();for(var e=[],t=0;t<this._expandInformations.length;t++){for(var n=this._expandInformations[t],r=n.elementParent?this._getElementChildren(n.elementParent):this._data,i=!1,o=0;o<e.length;o++)i=e[o].element===n.elementParent||i;i||-1===r.indexOf(n.element)?(n.elementChildren=[],e.push(n)):n.elementChildren=this._getElementChildren(n.element)}for(var s=0;s<e.length;s++)this.removeElementFromArray(this._expandInformations,e[s]);this.calculateExpandInformationIndexes()}},{key:"sortExpandInformations",value:function(){for(var e=[],t=0;t<this._expandInformations.length;t++){var n=this._expandInformations[t];if(n.elementParent){for(var r=!1,i=!1,o=void 0,s=0;s<e.length;s++){var l=e[s];if(r&&l.elementParent===o.elementParent&&l.elementIndex>n.elementIndex||r&&l.elementParent===n.elementParent&&l.elementIndex>n.elementIndex||r&&l.level<n.level||l.elementParent===n.element){e.splice(s,0,n),i=!0;break}l.element===n.elementParent&&(r=!0),o=l}i||e.push(n)}else{for(var a=!1,u=0;u<e.length;u++){var c=e[u];if(!c.elementParent&&c.elementIndex>n.elementIndex||c.elementParent===n.element){e.splice(u,0,n),a=!0;break}}a||e.push(n)}}this._expandInformations=e}},{key:"calculateExpandInformationIndexes",value:function(){for(var e=[],t=void 0,n=0,r=0;r<this._expandInformations.length;r++){var i=this._expandInformations[r];if(i.active){t&&(i.level>t.level&&e.push(t),i.level<t.level&&(e=e.slice(0,e.length-(t.level-i.level)))),i.totalLength=i.elementChildren.length;for(var o=0;o<e.length;o++)e[o].totalLength+=i.totalLength;var s=e.length>0?e[e.length-1]:void 0,l=s?s.index:void 0,a=s?s.totalLength-i.totalLength:0,u=s?s.elementChildren.length:0,c=e&&e.length>0?e[e.length-1].elementChildren.indexOf(i.element):this._data.indexOf(i.element),h=a-u+c+(void 0!==l?l+1:0)+(1===i.level?n:0);i.elementIndex=c,i.index=h,t=i,n+=i.elementChildren.length}}this.updateCurrentMaxIndex()}},{key:"rAF",value:function(e,t){var n=this,r=[].slice.call(arguments,2);this.virtualEnvironment?e.apply(this,r):t?(this._frameRequests[t]&&window.cancelAnimationFrame(this._frameRequests[t]),this._frameRequests[t]=window.requestAnimationFrame(function(){e.apply(n,r),delete n._frameRequests[t]})):window.requestAnimationFrame(function(){return e.apply(n,r)})}},{key:"removeElementFromArray",value:function(e,t){var n=e?e.indexOf(t):-1;return n>-1?e.splice(n,1):void 0}}]),e}()});
