<html>
	<head>
		<meta charset="UTF-8">
		<meta name="google" value="notranslate">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
		<link rel="stylesheet" type="text/css" href="common/common.css">
		<script type="text/javascript" src="../src/mnstr.js"></script>
		<script type="text/javascript" src="common/datagen.js"></script>
		<script type="text/javascript" src="common/templates.js"></script>
		<style type="text/css">
			.mnstr {
				height: 100%;
				width: 100%;
			}
		</style>
	</head>
	<body>
		<script type="text/javascript">
			var dataGen 	= new DataGen({maxLevel: 0});
			var data 		= dataGen.generate({rootElements: 100});
			var isLoading;

			// Prepare data. Push a new element which identifies as a "loading" placeholder.
			// This element will render with a different cell renderer.

			data.push({
				id: 	'loader',
				label: 	'getting more items'
			});

			var list = new MNSTR({
				getData: 			function (list) {
										return data;
									},
				getCellRenderer: 	function (element, index, isExpanded, list) {
										return typeof element.id === 'number'
											? getRendererSimple(element, data, list)
											: getRendererLoader(element);
									},
			});

			list.addEventListener('didRenderLastElement', function (element, list) {
				if (isLoading ||Â typeof element.id === 'number') {
					return;
				}

				// Generate some new data and remove the "loading" placeholder from
				// the existing data. Then concat old data and new data.

				var loadingElement 	= data.pop();
				var freshData 		= dataGen.generate({rootElements: 100, startIndex: data.length});

				data = data.concat(freshData);

				if (data.length < 500) {
					data = data.concat(loadingElement);
				}

				// To simulate "loading", update the list a bit later.

				isLoading = setTimeout(function () {
					list.dataUpdated();
					isLoading = undefined;
				}, 2000);
			});
		</script>
	</body>
</html>
